import{K as W,r as i,j as t,L as Q,$ as J,S as x,a as Z}from"./app-DWLvIQdF.js";import q from"./BreadcrumbsHeader-Cn59CTpR.js";import{S as ee}from"./AdminLayout-DF3T9r93.js";import te from"./ActionMenu-BTp0V9kb.js";import se from"./DynamicTable-D6nhkc6_.js";import{B as D}from"./button-D5oOHpih.js";import{I as oe}from"./input-Bjq-UOVg.js";import{M as ie,m as ae,H as le,n as ne,o as re,p as de,R as ce,b as me}from"./constants-BC8DDBPg.js";import ue from"./DynamicTableControls-Zyjm1i4x.js";import{F as pe}from"./FillterToggle-C8sWYfDm.js";import he from"./PersonDetailContent-Da4-28D9.js";import xe from"./SidebarModal-vxJbyoHl.js";import{u as fe}from"./useAppUrl-DygNqr49.js";import ge from"./DeleteConfirmationModal-BeH75Yd3.js";import{t as R,T as we}from"./index-DiQ2ABd4.js";import{H as ye}from"./users-round-DfUg6NaG.js";import{S as be}from"./search-G9nvaKgi.js";import{N as _e}from"./network-B9_qBKdy.js";import{E as je}from"./eye-dW3Ce4Eu.js";import{S as Ee}from"./square-pen-Cxeeoy9N.js";import{X as Ne}from"./x-Dj4h3Hl7.js";import"./breadcrumb-Tr7bH4sQ.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./chevron-right-B7veGfa5.js";import"./createLucideIcon-COg8xDid.js";import"./sidebar-B55M1Lhe.js";import"./index-C7xi9LN0.js";import"./index-DaxHkuH7.js";import"./floating-ui.react-dom-TXoiB1Cy.js";import"./skeleton-DxhMNfTQ.js";import"./tooltip-DGgHmMGp.js";import"./nav-user-ifqrtdkH.js";import"./avatar-xvo1q8ho.js";import"./dropdown-menu-301tgmQC.js";import"./check-DAMLPx8H.js";import"./heart-pulse-DBmhNY90.js";import"./chevron-up-DDEZVR48.js";import"./ellipsis-BLBb_BVq.js";import"./iconBase-BwLSqiDZ.js";import"./index-BHp23fmt.js";import"./index-CidfdT4c.js";function xt({members:r,family_details:f,household_details:Se,queryParams:a=null}){const I=[{label:"Residents Information",showOnMobile:!1},{label:"Families",href:route("family.index"),showOnMobile:!1},{label:"View Family",showOnMobile:!0}],O=fe();a=a||{};const l=W().props,d=(l==null?void 0:l.success)??null,c=(l==null?void 0:l.error)??null,[g,k]=i.useState(a.name??""),[w,C]=i.useState(null),A=e=>{e.preventDefault(),m("name",g)},m=(e,s)=>{s&&s.trim()!==""?a[e]=s:delete a[e],a.page&&delete a.page,x.get(route("family.showfamily",{family:f.id,...a}))},M=(e,s)=>{if(s.key==="Enter")m(e,s.target.value);else return},u=[{key:"resident_id",label:"Resident ID"},{key:"name",label:"Resident Name"},{key:"gender",label:"Gender"},{key:"age",label:"Age"},{key:"relationship_to_head",label:"Relationship to Head"},{key:"household_position",label:"Household Position"},{key:"employment_status",label:"Employment Status"},{key:"registered_voter",label:"Register Voter"},{key:"is_pwd",label:"Is PWD"},{key:"actions",label:"Actions"}],F=e=>{x.get(route("resident.edit",e))},[H,p]=i.useState(!1),[y,L]=i.useState(null),U=e=>{L(e),p(!0)},V=()=>{x.get(route("family.remove",y)),p(!1)},$=e=>{if(!e)return"Unknown";const s=new Date(e),o=new Date;let n=o.getFullYear()-s.getFullYear();const T=o.getMonth()-s.getMonth();return(T<0||T===0&&o.getDate()<s.getDate())&&n--,n},[P,b]=i.useState(!1),[_,X]=i.useState(null),z=async e=>{try{const s=await Z.get(`${O}/resident/showresident/${e}`);X(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}b(!0)},[j,E]=i.useState(u.map(e=>e.key)),[B,ve]=i.useState(!0),[N,G]=i.useState(!1),h=Object.entries(a||{}).some(([e,s])=>["gender","age_group","relation","household_position","estatus","voter_status","is_pwd"].includes(e)&&s&&s!=="All");i.useEffect(()=>{h&&v(!0)},[h]);const[S,v]=i.useState(h),K=()=>{window.print()};i.useEffect(()=>{if(!Array.isArray(r))return;const e=r.find(s=>{var o;return(o=s.household_residents)==null?void 0:o.some(n=>n.relationship_to_head==="self")});C((e==null?void 0:e.id)??null)},[r]);const Y={resident_id:e=>e.id,name:e=>`${e.firstname} ${e.middlename??""} ${e.lastname??""} ${e.suffix??""}`,gender:e=>{const s=e.gender,o=ce[s]??"Unknown",n=me[s]??"bg-gray-300";return t.jsx("span",{className:`py-1 px-2 rounded-xl text-sm font-medium ${n}`,children:o})},age:e=>{const s=$(e.birthdate);return typeof s!="number"?"Unknown":t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("span",{className:"font-medium text-gray-800",children:[s," years old"]}),s>60&&t.jsx("span",{className:"text-xs text-rose-600 font-semibold",children:"Senior Citizen"})]})},relationship_to_head:e=>{var s,o;return ne[(o=(s=e.household_residents)==null?void 0:s[0])==null?void 0:o.relationship_to_head]||""},household_position:e=>{var s,o;return le[(o=(s=e.household_residents)==null?void 0:s[0])==null?void 0:o.household_position]||""},employment_status:e=>ae[e==null?void 0:e.employment_status],registered_voter:e=>{const s=(e==null?void 0:e.registered_voter)??0,o=re[s]??"Unknown",n=de[s]??"p-1 bg-gray-300 text-black rounded-lg";return t.jsx("span",{className:n,children:o})},is_pwd:e=>ie[e==null?void 0:e.is_pwd],actions:e=>t.jsx(te,{actions:[{label:"View",icon:t.jsx(je,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>z(e.id)},{label:"Edit",icon:t.jsx(Ee,{className:"w-4 h-4 text-green-500"}),onClick:()=>F(e.id)},{label:"Remove",icon:t.jsx(Ne,{className:"w-4 h-4 text-red-600"}),onClick:()=>U(e.id)}]})};return i.useEffect(()=>{d&&R.success(d,{description:"Operation successful!",duration:3e3,closeButton:!0}),l.success=null},[d]),i.useEffect(()=>{c&&R.error(c,{description:"Operation failed!",duration:3e3,closeButton:!0}),l.error=null},[c]),t.jsxs(ee,{children:[t.jsx(Q,{title:"Family"}),t.jsx(q,{breadcrumbs:I}),t.jsx(we,{richColors:!0}),t.jsx("div",{className:"pt-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:t.jsx(ye,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Family Details"}),t.jsx("p",{className:"text-sm text-gray-500",children:"View and manage the records of this specific family, including members, relationships, and household links."})]})]})}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:t.jsx(ue,{allColumns:u,visibleColumns:j,setVisibleColumns:E,onPrint:K,showFilters:S,toggleShowFilters:()=>v(e=>!e)})}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:A,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(oe,{type:"text",placeholder:"Search for Household Member Name",value:g,onChange:e=>k(e.target.value),onKeyDown:e=>M("name",e),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(D,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(be,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),w&&t.jsx(J,{href:route("resident.familytree",{resident:w}),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(D,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(_e,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Family Tree"})]})})]})]}),S&&t.jsx(pe,{queryParams:a,searchFieldName:m,visibleFilters:["gender","age_group","relation","household_position","estatus","voter_status","is_pwd"],showFilters:!0,clearRouteName:"family.showfamily",clearRouteParams:{family:f.id}}),t.jsx(se,{passedData:r,columnRenderers:Y,allColumns:u,is_paginated:B,toggleShowAll:()=>G(!N),showAll:N,visibleColumns:j,setVisibleColumns:E})]})})}),t.jsx(xe,{isOpen:P,onClose:()=>b(!1),title:"Resident Details",children:_&&t.jsx(he,{person:_})}),t.jsx(ge,{isOpen:H,onClose:()=>{p(!1)},onConfirm:V,residentId:y,title:"Confirm Removal",message:"Are you sure you want to remove resident from this household? This action cannot be undone.",buttonLabel:"I UNDERSTAND, REMOVE"})]})}export{xt as default};
