import{K as G,m as X,r as x,j as e,L as q}from"./app-CSbLTV9t.js";import J from"./BreadcrumbsHeader-CQaDVuiA.js";import{D as $}from"./DropdownInputField-D-lPqSgr.js";import{I as p}from"./InputError-BCqWxJV0.js";import{I as d}from"./InputField-B1L9QxNV.js";import{I as B}from"./InputLabel-D9dJg9rZ.js";import{I as K,a as Q}from"./index-k6Ra7WmB.js";import{B as H}from"./button-Baqcf9KW.js";import{t as b,T as Z}from"./index-BKWT8n_e.js";import{R as ee,e as o}from"./constants-CQOY_faM.js";import{S as te}from"./AdminLayout-CQAB1boG.js";import{T as se}from"./textarea-Bqc0VVhC.js";import{R as ae}from"./rotate-ccw-CP5E-4aB.js";import"./breadcrumb-BysmSHHT.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./chevron-right-ZDo9j4tz.js";import"./createLucideIcon-K65SoRPX.js";import"./sidebar-EM1pc_Vu.js";import"./input-HZV2GfRj.js";import"./index-BWMtPXXG.js";import"./index-CLKsPuj0.js";import"./floating-ui.react-dom-DHVDvaGl.js";import"./x-DSSMIW7T.js";import"./skeleton-C3jJoeQy.js";import"./tooltip-b0GAWXCC.js";import"./iconBase-DIY0yPu9.js";import"./nav-user-qFIfSs4r.js";import"./avatar-DBnd5X0z.js";import"./dropdown-menu-DsAxoPEU.js";import"./check-xGOvrYiq.js";import"./useAppUrl-CCPDQKWJ.js";import"./users-round-CTpkNJgD.js";import"./heart-pulse-CgKjARwL.js";import"./chevron-up-BdT9BwPw.js";function He({record:n}){var j,w,y,N,C,I,M,k,D,E,S,O,A,F,R,T;const L=[{label:"Medical Information",showOnMobile:!1},{label:"Child Health Monitoring Records",showOnMobile:!1,href:route("child_record.index")},{label:"Add Child Health Record",showOnMobile:!0}],h=G().props,_=(h==null?void 0:h.success)??null,v=(h==null?void 0:h.error)??null,{data:a,setData:c,post:V,errors:g,reset:U}=X({id:n.id,resident_id:n.resident_id??null,head_circumference:n.head_circumference??"",developmental_milestones:n.developmental_milestones??"",immunizations_updated:n.immunizations_updated??"",resident_name:n.resident?`${n.resident.firstname} ${n.resident.middlename||""} ${n.resident.lastname} ${n.resident.suffix||""}`.trim():"",birthdate:((j=n.resident)==null?void 0:j.birthdate)??"",sex:((w=n.resident)==null?void 0:w.sex)??"",resident_image:((y=n.resident)==null?void 0:y.resident_picture_path)??null,weight_kg:((C=(N=n.resident)==null?void 0:N.medical_information)==null?void 0:C.weight_kg)??"",height_cm:((M=(I=n.resident)==null?void 0:I.medical_information)==null?void 0:M.height_cm)??"",bmi:((D=(k=n.resident)==null?void 0:k.medical_information)==null?void 0:D.bmi)??"",nutrition_status:n.nutrition_status??((S=(E=n.resident)==null?void 0:E.medical_information)==null?void 0:S.nutrition_status)??"",vaccinations:((A=(O=n.resident)==null?void 0:O.vaccinations)==null?void 0:A.length)>0?n.resident.vaccinations.map(t=>({id:t.id,vaccine:t.vaccine,vaccination_date:t.vaccination_date})):[{vaccine:"",vaccination_date:""}],age:(F=n.resident)!=null&&F.birthdate?(()=>{const t=new Date(n.resident.birthdate),s=new Date;let i=s.getFullYear()-t.getFullYear();const u=s.getMonth()-t.getMonth(),m=s.getDate()-t.getDate();return(u<0||u===0&&m<0)&&i--,i})():0,age_in_months:(R=n.resident)!=null&&R.birthdate?(()=>{const t=new Date(n.resident.birthdate),s=new Date;let i=(s.getFullYear()-t.getFullYear())*12+(s.getMonth()-t.getMonth());return s.getDate()<t.getDate()&&i--,i})():"",_method:"PUT"}),Y=t=>{t.preventDefault(),V(route("child_record.update",a.id),{onSuccess:()=>{b.success("Child health record updated successfully.")},onError:s=>{const i=Object.values(s).map((u,m)=>`<div key=${m}> ${u}</div>`);b.error("Validation Error",{description:e.jsx("div",{dangerouslySetInnerHTML:{__html:i.join("")}}),duration:4e3,closeButton:!0})}})},P=(t,s,i,u)=>{if(!t||!s||i==null)return{bmi:null,status:""};const m=s/100,l=t/(m*m);let r="";return i>=20?l<18.5?r=o.underweight:l<=24.9?r=o.normal:l<=29.9?r=o.overweight:r=o.obese:i>=5?l<15?r=o.severely_underweight:l<19?r=o.normal:l<23?r=o.overweight:r=o.obese:l<13?r=o.severely_underweight:l<14?r=o.underweight:l<=18?r=o.normal:l<=20?r=o.overweight:r=o.obese,{bmi:parseFloat(l.toFixed(2)),status:r}};x.useEffect(()=>{if(a.weight_kg&&a.height_cm){const{bmi:t,status:s}=P(a.weight_kg,a.height_cm,a.age,a.gender);c(i=>({...i,bmi:t,nutrition_status:s}))}else c(t=>({...t,bmi:null,nutrition_status:""}))},[a.weight_kg,a.height_cm]),x.useEffect(()=>{if(a.weight_kg&&a.height_cm){const t=a.height_cm/100,s=a.weight_kg/(t*t);c(i=>({...i,bmi:s.toFixed(2),nutrition_status:s<13?"Severely Underweight":s<14?"Underweight":s<=18?"Normal":s<=20?"Overweight":"Obese"}))}},[a.weight_kg,a.height_cm]);const f=(t,s,i,u)=>{c(m=>{const l=[...m[t]];return l[s]={...l[s],[i]:u},{...m,[t]:l}})},z=(t,s)=>{c(i=>({...i,[t]:[...i[t],s]}))},W=(t,s)=>{c(i=>({...i,[t]:i[t].filter((u,m)=>m!==s)}))};return x.useEffect(()=>{_&&(handleModalClose(),b.success(_,{description:"Operation successful!",duration:3e3,closeButton:!0})),h.success=null},[_]),x.useEffect(()=>{v&&b.error(v,{description:"Operation failed!",duration:3e3,closeButton:!0}),h.error=null},[v]),e.jsxs(te,{children:[e.jsx(Z,{richColors:!0}),e.jsx(q,{title:"Medical Information"}),e.jsx(J,{breadcrumbs:L}),e.jsx("div",{children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6",children:e.jsx("div",{className:"overflow-hidden bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 my-8",children:e.jsxs("div",{className:" my-2 p-5",children:[v&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:v}),e.jsx("div",{children:e.jsxs("form",{onSubmit:Y,children:[e.jsx("h2",{className:"text-3xl font-semibold text-gray-800 mb-1",children:"Child Health Monitoring"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Record weight, height, and health details for the selected resident."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-y-2 md:gap-x-4 mb-5",children:[e.jsxs("div",{className:"md:row-span-2 flex flex-col items-center space-y-2",children:[e.jsx(B,{htmlFor:"resident_image",value:"Profile Photo"}),e.jsx("img",{src:a.resident_image?`/storage/${a.resident_image}`:"/images/default-avatar.jpg",alt:"Resident Image",className:"w-32 h-32 object-cover rounded-full border border-gray-200"})]}),e.jsxs("div",{className:"md:col-span-5 space-y-2",children:[e.jsxs("div",{className:"w-full",children:[e.jsx($,{label:"Full Name",name:"fullname",value:a.resident_name||"",placeholder:"Select a resident",onChange:t=>handleResidentChange(t.target.value)}),e.jsx(p,{message:g.resident_id,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-2",children:[e.jsx(d,{label:"Birthdate",name:"birthdate",value:a.birthdate||"",readOnly:!0}),e.jsx(d,{label:"Sex",name:"sex",value:ee[a.sex||""],readOnly:!0}),e.jsx(d,{label:"Age",name:"age",value:a.age||"",readOnly:!0}),e.jsx(d,{label:"Age In Months",name:"age_in_months",value:a.age_in_months||"",readOnly:!0})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4 mb-5",children:[e.jsxs("div",{children:[e.jsx(d,{label:"Weight (kg)",name:"weight_kg",type:"number",step:"0.1",value:a.weight_kg,onChange:t=>c("weight_kg",t.target.value)}),e.jsx(p,{message:g.weight_kg,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(d,{label:"Height (cm)",name:"height_cm",type:"number",step:"0.1",value:a.height_cm,onChange:t=>c("height_cm",t.target.value)}),e.jsx(p,{message:g.height_cm,className:"mt-2"})]}),e.jsx("div",{children:e.jsx(d,{label:"Nutrition Status",name:"nutrition_status",value:a.nutrition_status||"",placeholder:"Automatically determined",disabled:!0})}),e.jsxs("div",{children:[e.jsx(d,{label:"Head Circumference (cm)",name:"head_circumference",type:"number",step:"0.1",value:a.head_circumference,onChange:t=>c("head_circumference",t.target.value)}),e.jsx(p,{message:g.head_circumference,className:"mt-2"})]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx(B,{htmlFor:"developmental_milestones",value:"Developmental Milestones",className:"mb-2"}),e.jsx(se,{id:"developmental_milestones",name:"developmental_milestones",placeholder:"Write observed developmental milestones here...",value:a.developmental_milestones,onChange:t=>c("developmental_milestones",t.target.value)}),e.jsx(p,{message:g.developmental_milestones,className:"mt-2"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Vaccinations"}),(T=a.vaccinations)==null?void 0:T.map((t,s)=>e.jsxs("div",{className:"border p-4 mb-4 rounded-md relative bg-gray-50",children:[e.jsx($,{label:"Vaccine",name:`vaccinations.${s}.vaccine`,value:t.vaccine||"",placeholder:"Select a vaccine",onChange:i=>f("vaccinations",s,"vaccine",i.target.value)}),e.jsx(p,{message:g[`vaccinations.${s}.vaccine`],className:"mt-2"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(d,{label:"Vaccination Date",name:`vaccinations.${s}.vaccination_date`,type:"date",value:t.vaccination_date||"",onChange:i=>f("vaccinations",s,"vaccination_date",i.target.value)}),e.jsx(p,{message:g[`vaccinations.${s}.vaccination_date`],className:"mt-2"})]}),a.vaccinations.length>1&&e.jsx("button",{type:"button",onClick:()=>W("vaccinations",s),className:"absolute top-1 right-2 text-sm text-red-500 hover:text-red-800",children:e.jsx(K,{className:"text-2xl"})})]},s)),e.jsxs("button",{type:"button",onClick:()=>z("vaccinations",{vaccine:"",vaccination_date:""}),className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1 mb-6",children:[e.jsx(Q,{className:"text-2xl"}),e.jsx("span",{children:"Add Vaccination"})]})]}),e.jsxs("div",{className:"flex w-full justify-end items-center mt-7 gap-4",children:[e.jsxs(H,{type:"button",onClick:()=>U(),children:[e.jsx(ae,{})," Reset"]}),e.jsx(H,{className:"w-40 bg-blue-700 hover:bg-blue-400",type:"submit",children:"Submit"})]})]})})]})})})})]})}export{He as default};
