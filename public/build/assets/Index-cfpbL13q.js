import{K as ne,r as n,m as le,j as e,L as oe,S as X,a as ie}from"./app-OMiIBAVv.js";import{S as de}from"./AdminLayout-CUYq8DRk.js";import{B}from"./button-DSR4zr8t.js";import{I as me}from"./input-BGuCCM3F.js";import ce from"./BreadcrumbsHeader-D7yXDAqZ.js";import{t as x,T as ge}from"./index-0Qv22I-m.js";import ue from"./DynamicTable-UkXv7no2.js";import xe from"./ActionMenu-BwZQbtv1.js";import pe from"./SidebarModal-BhCVnGdX.js";import be from"./DynamicTableControls-D0m5fsZs.js";import{F as ye}from"./FillterToggle-DNCt5F0M.js";import{u as he}from"./useAppUrl-D_iSPAaw.js";import fe from"./DeleteConfirmationModal-TJ1uBlKB.js";import"./index-BLQZ4u8d.js";import{I as m}from"./InputError-LtgWhWIb.js";import{I as c}from"./InputLabel-Cqcva6ji.js";import{I as p}from"./InputField-BN9Kcp6u.js";import{E as _e}from"./EmailValidationInput-eCG8JMFr.js";import"./switch-oBO6LwX8.js";import{M as je}from"./map-pin--ZILEUGv.js";import{S as ve}from"./search-B5GIhMYd.js";import{S as Ne}from"./square-plus-BWruN1FS.js";import{M as we}from"./move-right-OsZnL4gk.js";import{P as Se}from"./pencil-BfMjaP7Q.js";import{T as ke}from"./trash-2-jR1sYQPd.js";import"./sidebar-8I0oMIHa.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-CI6SsBKC.js";import"./floating-ui.react-dom-CMRH_ZRG.js";import"./x-CWRGpm6F.js";import"./createLucideIcon-Axl_0YCz.js";import"./skeleton-B3ns0wAt.js";import"./tooltip-DovJGv4D.js";import"./nav-user-CHo7Aeqf.js";import"./avatar-EoKRnGG_.js";import"./dropdown-menu-Bvu9yf_7.js";import"./check-CuPlmUjy.js";import"./chevron-right-Cy23RFOt.js";import"./users-round-DM5XvS4t.js";import"./heart-pulse-BEye5CQy.js";import"./chevron-up-aIKK6lnp.js";import"./breadcrumb-BupgMzbl.js";import"./ellipsis-PuzZ1_TO.js";import"./constants-iESbBslm.js";function fa({queryParams:l,barangays:A}){const L=[{label:"Barangay Information",showOnMobile:!1},{label:"Accounts",showOnMobile:!0}];l=l||{};const y=he(),i=ne().props,h=(i==null?void 0:i.success)??null,f=(i==null?void 0:i.error)??null,[T,_]=n.useState(!1),[E,F]=n.useState(null),[I,U]=n.useState(l.name??""),[$,j]=n.useState(!1),[g,v]=n.useState(""),R=a=>{a.preventDefault(),N("name",I)},N=(a,t)=>{t&&t.trim()!==""?l[a]=t:delete l[a],l.page&&delete l.page,X.get(route("barangay.index",l))},q=(a,t)=>{if(t.key==="Enter")N(a,t.target.value);else return},w=[{key:"id",label:"ID"},{key:"logo_path",label:"Logo"},{key:"barangay_name",label:"Barangay Name"},{key:"contact_number",label:"Contact Number"},{key:"area_sq_km",label:"Area (sq km)"},{key:"email",label:"Email"},{key:"founded_year",label:"Founded Year"},{key:"barangay_code",label:"Barangay Code"},{key:"barangay_type",label:"Type"},{key:"actions",label:"Actions"}],S=Object.entries(l||{}).some(([a,t])=>["brgy_type"].includes(a)&&t&&t!=="");n.useEffect(()=>{S&&D(!0)},[S]);const[O,D]=n.useState(S),[z,Ce]=n.useState(!0),[M,V]=n.useState(!1),H={id:a=>e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:a.id}),logo_path:a=>e.jsx("img",{src:a.logo_path?`/storage/${a.logo_path}`:"/images/city-of-ilagan.png",onError:t=>{t.target.onerror=null,t.target.src="/images/city-of-ilagan.png"},alt:a.barangay_name||"Barangay Logo",className:"w-16 h-16 min-w-16 min-h-16 object-cover rounded-full border",loading:"lazy"}),barangay_name:a=>e.jsx("span",{className:"text-sm font-semibold text-gray-800",children:a.barangay_name??"—"}),contact_number:a=>e.jsx("span",{className:"text-xs text-gray-600",children:a.contact_number??"—"}),area_sq_km:a=>e.jsx("span",{className:"text-xs text-gray-600",children:a.area_sq_km??"—"}),email:a=>e.jsx("span",{className:"text-xs text-gray-600",children:a.email??"—"}),founded_year:a=>e.jsx("span",{className:"text-xs text-gray-600",children:a.founded_year??"—"}),barangay_code:a=>e.jsx("span",{className:"text-xs text-gray-600",children:a.barangay_code??"—"}),barangay_type:a=>{const t=a.barangay_type??"—",r=t==="urban";return e.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${r?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:t.toUpperCase()})},actions:a=>e.jsx(xe,{actions:[{label:"Edit",icon:e.jsx(Se,{className:"w-4 h-4 text-blue-600"}),onClick:()=>te(a.id)},{label:"Delete",icon:e.jsx(ke,{className:"w-4 h-4 text-red-600"}),onClick:()=>re(a.id)}]})},{data:s,setData:o,post:K,put:P,errors:d,reset:J,clearErrors:Y}=le({barangay_name:"",contact_number:"",area_sq_km:"",email:"",logo_path:"",founded_year:"",barangay_code:"",barangay_type:"urban",barangay_id:null,_method:void 0}),Q=w.map(a=>a.key),[b,G]=n.useState(()=>{const a=localStorage.getItem("barangays_visible_columns");return a?JSON.parse(a):Q});n.useEffect(()=>{localStorage.setItem("barangays_visible_columns",JSON.stringify(b))},[b]);const k=()=>{v(null),j(!1),J(),Y(),F(null)},W=()=>{v("add"),j(!0)},Z=a=>{a.preventDefault(),K(route("barangay.store"),{onError:t=>{const r=Object.values(t).map((u,C)=>`<div key=${C}>${u}</div>`);x.error("Validation Error",{description:e.jsx("div",{dangerouslySetInnerHTML:{__html:r.join("")}}),duration:4e3,closeButton:!0})}})},ee=a=>{a.preventDefault(),P(route("barangay.update",s.barangay_id),{onError:t=>{const r=Object.values(t).map((u,C)=>`<div key=${C}>${u}</div>`);x.error("Validation Error",{description:e.jsx("div",{dangerouslySetInnerHTML:{__html:r.join("")}}),duration:4e3,closeButton:!0})}})},ae=()=>{window.print()},te=async a=>{try{const t=await ie.get(`${y}/super_admin/barangay_details/${a}`);console.log(t);const r=t.data;v("edit"),j(!0);const u=r.logo_path?`${y}/storage/${r.logo_path}`:"/images/default-logo.png";o({barangay_id:r.id,barangay_name:r.barangay_name||"",barangay_type:r.barangay_type||"",barangay_code:r.barangay_code||"",city:r.city||"",province:r.province||"",zip_code:r.zip_code||"",contact_number:r.contact_number||"",email:r.email||"",founded_year:r.founded_year||"",area_sq_km:r.area_sq_km||"",logo_path:null,previewImage:u,originalLogo:r.logo_path||"",originalEmail:r.email||"",_method:"PUT"})}catch(t){console.error("Error fetching barangay details:",t),x.error("Failed to fetch barangay details.")}},re=a=>{F(a),_(!0)},se=()=>{X.delete(route("barangay.destroy",E)),_(!1)};return n.useEffect(()=>{h&&(k(),x.success(h,{description:"Operation successful!",duration:3e3,closeButton:!0})),i.success=null},[h]),n.useEffect(()=>{f&&(x.error(f,{description:"Operation failed!",duration:3e3,closeButton:!0}),k()),i.error=null},[f]),e.jsxs(de,{children:[e.jsx(oe,{title:"Barangay Information"}),e.jsxs("div",{children:[e.jsx(ge,{richColors:!0}),e.jsx(ce,{breadcrumbs:L}),e.jsx("div",{className:"p-2 md:p-4",children:e.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-green-50 rounded-xl shadow-sm",children:[e.jsx("div",{className:"flex-shrink-0 p-3 bg-green-100 rounded-full",children:e.jsx(je,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Barangays"}),e.jsxs("p",{className:"mt-1 md:mt-2 text-gray-600 text-sm md:text-base",children:["Manage and monitor"," ",e.jsx("span",{className:"font-medium text-gray-800",children:"barangays"})," ","within the system. Use the tools below to"," ",e.jsx("span",{className:"font-medium text-gray-800",children:"create, update, filter, or export"})," ","barangay information for administrative and operational purposes."]})]})]})}),e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:e.jsx(be,{allColumns:w,visibleColumns:b,setVisibleColumns:G,onPrint:ae,showFilters:O,toggleShowFilters:()=>D(a=>!a)})}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:e.jsxs("form",{onSubmit:R,className:"flex w-[380px] max-w-lg items-center space-x-1",children:[e.jsx(me,{type:"text",placeholder:"Search Barangay Name",value:I,onChange:a=>U(a.target.value),onKeyDown:a=>q("name",a.target.value),className:"w-full"}),e.jsxs("div",{className:"relative group z-50",children:[e.jsx(B,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:e.jsx(ve,{})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]}),e.jsxs("div",{className:"relative group z-50",children:[e.jsx(B,{className:"bg-blue-700 hover:bg-blue-400 ",type:"button",onClick:W,children:e.jsx(Ne,{})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Barangay"})]})]})})]}),O&&e.jsx(ye,{queryParams:l,searchFieldName:N,visibleFilters:["brgy_type"],showFilters:!0,clearRouteName:"barangay.index",clearRouteParams:{}}),e.jsx(ue,{passedData:A,allColumns:w,columnRenderers:H,queryParams:l,is_paginated:z,toggleShowAll:()=>V(!M),showAll:M,visibleColumns:b})]})})}),e.jsx(pe,{isOpen:$,onClose:k,title:g==="add"?"Add Barangay":"Edit Barangay",children:e.jsx("div",{className:"w-full rounded-xl border border-white/20 bg-white/10 backdrop-blur-md shadow-lg text-sm text-black p-6 space-y-6",children:e.jsxs("form",{onSubmit:g==="add"?Z:ee,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:g==="add"?"Create New Barangay":"Edit Barangay Details"}),e.jsx("p",{className:"text-gray-600 text-sm md:text-base",children:g==="add"?"Fill in the details below to add a new barangay. Ensure all required information is accurate.":"Update the barangay details. Any changes will reflect immediately in the system."})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-xl shadow-md border border-gray-200 w-full space-y-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Basic Information"}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["Enter the general information of the barangay. Fields marked with"," ",e.jsx("span",{className:"font-medium",children:"*"})," are required."]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"barangay_name",value:"Barangay Name *"}),e.jsx(p,{id:"barangay_name",name:"barangay_name",value:s.barangay_name||"",placeholder:"Enter barangay name",onChange:a=>o("barangay_name",a.target.value)}),e.jsx(m,{message:d.barangay_name,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"contact_number",value:"Contact Number"}),e.jsx(p,{id:"contact_number",name:"contact_number",value:s.contact_number||"",placeholder:"Optional: e.g., 0999-123-4567",onChange:a=>o("contact_number",a.target.value)}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Format: +63XXXXXXXXX or 0XXXXXXXXX"}),e.jsx(m,{message:d.contact_number,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"area_sq_km",value:"Area (sq km)"}),e.jsx(p,{id:"area_sq_km",name:"area_sq_km",value:s.area_sq_km||"",placeholder:"Optional",type:"number",onChange:a=>o("area_sq_km",a.target.value)}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Total land area of the barangay in square kilometers."}),e.jsx(m,{message:d.area_sq_km,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(_e,{isSuperAdmin:!0,data:s,setData:o,originalEmail:s.originalEmail??null}),e.jsx(m,{message:d.email,className:"mt-1"})]})]}),e.jsxs("div",{className:"md:col-span-2 flex flex-col items-center space-y-2",children:[e.jsx(c,{htmlFor:"barangay_logo",value:"Barangay Logo"}),e.jsx("img",{src:s.logo_path?URL.createObjectURL(s.logo_path):s.originalLogo?`${y}/storage/${s.originalLogo}`:"/images/city-of-ilagan.png",alt:"Barangay Logo",className:"w-32 h-32 object-cover rounded-full border border-gray-200 shadow-sm",onError:a=>{a.target.onerror=null,a.target.src="/images/city-of-ilagan.png"}}),e.jsx("input",{id:"barangay_logo",type:"file",accept:"image/*",onChange:a=>{const t=a.target.files[0];t&&o("logo_path",t)},className:`block w-full text-sm text-gray-500
                            file:mr-2 file:py-1 file:px-3
                            file:rounded file:border-0
                            file:text-xs file:font-semibold
                            file:bg-blue-50 file:text-blue-700
                            hover:file:bg-blue-100`}),e.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Upload a clear logo or image representing the barangay."}),e.jsx(m,{message:d.logo_path,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"founded_year",value:"Founded Year"}),e.jsx(p,{id:"founded_year",name:"founded_year",type:"number",value:s.founded_year||"",placeholder:"Optional: e.g., 1933",onChange:a=>o("founded_year",a.target.value)}),e.jsx(m,{message:d.founded_year,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"barangay_code",value:"Barangay Code"}),e.jsx(p,{id:"barangay_code",name:"barangay_code",value:s.barangay_code||"",placeholder:"Optional",onChange:a=>o("barangay_code",a.target.value)}),e.jsx(m,{message:d.barangay_code,className:"mt-1"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(c,{htmlFor:"barangay_type",value:"Barangay Type"}),e.jsxs("select",{id:"barangay_type",value:s.barangay_type||"urban",onChange:a=>o("barangay_type",a.target.value),className:"w-full border border-gray-300 rounded-md p-2",children:[e.jsx("option",{value:"urban",children:"Urban"}),e.jsx("option",{value:"rural",children:"Rural"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Select whether the barangay is classified as urban or rural."}),e.jsx(m,{message:d.barangay_type,className:"mt-1"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(B,{className:"bg-blue-700 hover:bg-blue-500 flex justify-end px-6 py-2 rounded-md font-semibold",type:"submit",children:[g==="add"?"Add Barangay":"Update Barangay"," ",e.jsx(we,{})]})})]})})}),e.jsx(fe,{isOpen:T,onClose:()=>{_(!1)},onConfirm:se,residentId:E})]})]})}export{fa as default};
