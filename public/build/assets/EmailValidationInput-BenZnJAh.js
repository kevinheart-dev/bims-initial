import{r as i,a as f,j as e}from"./app-CSbLTV9t.js";import{I as p}from"./InputField-B1L9QxNV.js";import{u as d}from"./useAppUrl-CCPDQKWJ.js";import{I as E}from"./InputLabel-D9dJg9rZ.js";import{C as j}from"./check-xGOvrYiq.js";import{X as C}from"./x-DSSMIW7T.js";function R({data:l,setData:o,originalEmail:u,isSuperAdmin:x=!1}){const[t,c]=i.useState(null),[n,s]=i.useState(null),[h,m]=i.useState(!1),g=d();return i.useEffect(()=>{if(!l.email){c(null),s(null);return}c(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email))},[l.email]),i.useEffect(()=>{if(!t||l.email===u){s(!0),m(!1);return}const a=new AbortController;return m(!0),f.post(`${g}/check-email-unique`,{email:l.email},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},signal:a.signal}).then(r=>{s(r.data.unique)}).catch(r=>{f.isCancel(r)||s(!1)}).finally(()=>m(!1)),()=>a.abort()},[l.email,t,u]),e.jsxs("div",{className:"w-full",children:[x?e.jsxs(e.Fragment,{children:[e.jsx(E,{htmlFor:"email",value:"Email"}),e.jsx(p,{id:"email",name:"email",type:"email",value:l.email||"",placeholder:"Optional: contact email",onChange:a=>o("email",a.target.value)})]}):e.jsx(p,{label:"Email",name:"email",type:"email",value:l.email||"",onChange:a=>o("email",a.target.value)}),t!==null&&e.jsxs("p",{className:`mt-1 text-sm flex items-center gap-1 ${t&&n!==!1?"text-green-600":"text-red-600"}`,children:[t&&n?e.jsx(j,{className:"w-4 h-4"}):e.jsx(C,{className:"w-4 h-4"}),t?h?"Checking uniqueness...":n===!1?"Email already taken":"Valid and unique email":"Invalid email format"]})]})}export{R as E};
