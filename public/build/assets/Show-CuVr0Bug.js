import{K as oe,r as a,j as t,L as ie,$ as U,S as f,a as M}from"./app-CSbLTV9t.js";import le from"./BreadcrumbsHeader-CQaDVuiA.js";import{S as ce}from"./AdminLayout-CQAB1boG.js";import me from"./DynamicTableControls-nJkmjrjE.js";import pe from"./DynamicTable-CYX8Y7lr.js";import{F as ue}from"./FillterToggle-p8HB-wA3.js";import de from"./SidebarModal-Ca0ENWih.js";import xe from"./PersonDetailContent-BL527x7d.js";import{B as _}from"./button-Baqcf9KW.js";import{I as ye}from"./input-HZV2GfRj.js";import{p as be,n as ge,m as fe,C as w,D as _e,G as we,J as Ee,K as he,M as Te,h as Se,H as je,i as Ne,j as ve,k as Oe,R as De,b as Re}from"./constants-CQOY_faM.js";import ke from"./ActionMenu-BTyRiOW7.js";import{u as He}from"./useAppUrl-CCPDQKWJ.js";import{u as Ie}from"./useQuery-CDQnuoFr.js";import Ce from"./DeleteConfirmationModal-C2yWkaRr.js";import{t as F,T as Ae}from"./index-BKWT8n_e.js";import{S as Le}from"./search-w3rx2qu6.js";import{c as Pe}from"./createLucideIcon-K65SoRPX.js";import{N as Ue}from"./network-BQNXsBXz.js";import{E as Me}from"./eye-CUAyTwAT.js";import{S as Fe}from"./square-pen-BBjInpuo.js";import{X as Xe}from"./x-DSSMIW7T.js";import"./breadcrumb-BysmSHHT.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./chevron-right-ZDo9j4tz.js";import"./sidebar-EM1pc_Vu.js";import"./index-BWMtPXXG.js";import"./index-CLKsPuj0.js";import"./floating-ui.react-dom-DHVDvaGl.js";import"./skeleton-C3jJoeQy.js";import"./tooltip-b0GAWXCC.js";import"./nav-user-qFIfSs4r.js";import"./avatar-DBnd5X0z.js";import"./dropdown-menu-DsAxoPEU.js";import"./check-xGOvrYiq.js";import"./users-round-CTpkNJgD.js";import"./heart-pulse-CgKjARwL.js";import"./chevron-up-BdT9BwPw.js";import"./iconBase-DIY0yPu9.js";import"./index-Bw3HOa7F.js";import"./index-BqPLuFbr.js";import"./ellipsis-Ci4G0pTK.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],We=Pe("share-2",$e);function Lt({household_details:s,household_members:X,queryParams:$=null}){var R,k,H,I,C,A,L,P;const W=[{label:"Residents Information",showOnMobile:!1},{label:"Households",href:route("household.index"),showOnMobile:!1},{label:"Household Details",showOnMobile:!0}],E=He(),o=oe().props,p=(o==null?void 0:o.success)??null,u=(o==null?void 0:o.error)??null,{data:h,isLoading:qe,isError:ze}=Ie({queryKey:["head",s.id],queryFn:async()=>{const{data:e}=await M.get(`${E}/household/getlatesthead/${s.id}`);return(e==null?void 0:e.head)||null},enabled:!!(s!=null&&s.id),staleTime:1e3*60*5}),i=$||{},[T,q]=a.useState(i.name??""),z=e=>{e.preventDefault(),d("name",T)},d=(e,r)=>{r&&r.trim()!==""?i[e]=r:delete i[e],i.page&&delete i.page,f.get(route("household.show",{household:s.id,...i}))},B=(e,r)=>{r.key==="Enter"&&d(e,r.target.value)},m=[{key:"resident_id",label:"Resident ID"},{key:"name",label:"Resident Name"},{key:"sex",label:"Sex"},{key:"relationship_to_head",label:"Relationship to Head"},{key:"household_position",label:"Household Position"},{key:"employment_status",label:"Employment Status"},{key:"registered_voter",label:"Register Voter"},{key:"is_pwd",label:"Is PWD"},{key:"actions",label:"Actions"}],[V,S]=a.useState(!1),[j,Y]=a.useState(null),K=async e=>{try{const r=await M.get(`${E}/resident/showresident/${e}`);Y(r.data.resident)}catch(r){console.error("Error fetching placeholders:",r)}S(!0)},[x,y]=a.useState(m.map(e=>e.key));a.useEffect(()=>{x.length===0&&y(m.map(e=>e.key))},[]);const[G,Be]=a.useState(!0),[N,Q]=a.useState(!1),b=Object.entries(i||{}).some(([e,r])=>["gender","age_group","relation","household_position","estatus","voter_status","is_pwd"].includes(e)&&r&&r!=="");a.useEffect(()=>{b&&O(!0)},[b]);const[v,O]=a.useState(b),J=()=>{window.print()},Z=e=>{f.get(route("resident.edit",e))},[ee,g]=a.useState(!1),[D,te]=a.useState(null),se=e=>{te(e),g(!0)},re=()=>{f.get(route("household.remove",D)),g(!1)},ae=e=>{if(!e)return"Unknown";const r=new Date(e),n=new Date;let l=n.getFullYear()-r.getFullYear();const c=n.getMonth()-r.getMonth();return(c<0||c===0&&n.getDate()<r.getDate())&&l--,l},ne={resident_id:e=>e.resident.id,name:e=>`${e.resident.firstname} ${e.resident.middlename??""} ${e.resident.lastname??""} ${e.resident.suffix??""}`,sex:e=>{const r=e.resident.sex,n=De[r]??"Unknown",l=Re[r]??"bg-gray-300";return t.jsx("span",{className:`py-1 px-2 rounded-xl text-sm font-medium ${l}`,children:n})},age:e=>{const r=ae(e.resident.birthdate);return typeof r!="number"?"Unknown":t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("span",{className:"font-medium text-gray-800",children:[r," years old"]}),r>60&&t.jsx("span",{className:"text-xs text-rose-600 font-semibold",children:"Senior Citizen"})]})},relationship_to_head:e=>Ne[e.relationship_to_head]||"",household_position:e=>je[e.household_position]||"",employment_status:e=>Se[e.resident.employment_status],registered_voter:e=>{var c;const r=((c=e.resident)==null?void 0:c.registered_voter)??0,n=ve[r]??"Unknown",l=Oe[r]??"p-1 bg-gray-300 text-black rounded-lg";return t.jsx("span",{className:l,children:n})},is_pwd:e=>{var r;return Te[(r=e.resident)==null?void 0:r.is_pwd]},actions:e=>t.jsx(ke,{actions:[{label:"View",icon:t.jsx(Me,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>K(e.resident_id)},{label:"Edit",icon:t.jsx(Fe,{className:"w-4 h-4 text-green-500"}),onClick:()=>Z(e.resident_id)},{label:"Remove",icon:t.jsx(Xe,{className:"w-4 h-4 text-red-600"}),onClick:()=>se(e.resident_id)}]})};return a.useEffect(()=>{p&&F.success(p,{description:"Operation successful!",duration:3e3,closeButton:!0}),o.success=null},[p]),a.useEffect(()=>{u&&F.error(u,{description:"Operation failed!",duration:3e3,closeButton:!0}),o.error=null},[u]),t.jsxs(ce,{children:[t.jsx(ie,{title:"Family"}),t.jsx(Ae,{richColors:!0}),t.jsx(le,{breadcrumbs:W}),t.jsxs("div",{className:"bg-white shadow-md rounded-lg m-5 border border-gray-200",children:[t.jsxs("div",{className:"px-4 py-4 border-b bg-gray-100 rounded-t-lg",children:[t.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["House #",s.house_number]}),t.jsxs("p",{className:"text-sm text-gray-600",children:[((k=(R=s==null?void 0:s.purok)==null?void 0:R.barangay)==null?void 0:k.barangay_name)||""," ","• Purok ",((H=s==null?void 0:s.purok)==null?void 0:H.purok_number)||""," •"," ",((I=s==null?void 0:s.street)==null?void 0:I.street_name)||""," Street"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-6",children:[{label:"Ownership Type",value:be[s.ownership_type]},{label:"Housing Condition",value:ge[s.housing_condition]},{label:"Year Established",value:s.year_established},{label:"House Structure",value:fe[s.house_structure]},{label:"Bath & Wash Area",value:Array.isArray(s.bath_and_wash_area)?s.bath_and_wash_area.map(e=>w[e]||e).join(", "):typeof s.bath_and_wash_area=="object"?Object.values(s.bath_and_wash_area).map(e=>w[e]||e).join(", "):w[s.bath_and_wash_area]||s.bath_and_wash_area},{label:"Rooms",value:s.number_of_rooms},{label:"Floors",value:s.number_of_floors},{label:"Coordinates",value:`${s.latitude}, ${s.longitude}`},{label:"Toilet Types",value:((C=s.toilets)==null?void 0:C.length)>0?s.toilets.map(e=>_e[e.toilet_type]||e.toilet_type).join(", "):"None"},{label:"Waste Management Types",value:((A=s.waste_management_types)==null?void 0:A.length)>0?s.waste_management_types.map(e=>we[e.waste_management_type]||e.waste_management_type).join(", "):"None"},{label:"Water Source Types",value:((L=s.water_source_types)==null?void 0:L.length)>0?s.water_source_types.map(e=>Ee[e.water_source_type]||e.water_source_type).join(", "):"None"},{label:"Electricity Types",value:((P=s.electricity_types)==null?void 0:P.length)>0?s.electricity_types.map(e=>he[e.electricity_type]||e.electricity_type).join(", "):"None"}].map(({label:e,value:r},n)=>t.jsxs("div",{className:"flex justify-between border-b pb-2",children:[t.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[e,":"]}),t.jsx("span",{className:"text-sm text-gray-900 text-right max-w-[60%]",children:r||"—"})]},n))})]}),t.jsx("div",{className:"pt-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:t.jsx(me,{allColumns:m,visibleColumns:x,setVisibleColumns:y,onPrint:J,showFilters:v,toggleShowFilters:()=>O(e=>!e)})}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:z,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(ye,{type:"text",placeholder:"Search for Household Member Name",value:T,onChange:e=>q(e.target.value),onKeyDown:e=>B("name",e),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(_,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(Le,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),t.jsx(U,{href:route("family.create"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(_,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(We,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Relationship"})]})}),h&&t.jsx(U,{href:route("resident.familytree",h.resident_id),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(_,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(Ue,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Family Tree"})]})})]})]}),v&&t.jsx(ue,{queryParams:i,searchFieldName:d,visibleFilters:["gender","age_group","relation","household_position","estatus","voter_status","is_pwd"],showFilters:!0,clearRouteName:"household.show",clearRouteParams:{household:s.id}}),t.jsx(pe,{passedData:X,columnRenderers:ne,allColumns:m,is_paginated:G,toggleShowAll:()=>Q(!N),showAll:N,visibleColumns:x,setVisibleColumns:y})]})})}),t.jsx(de,{isOpen:V,onClose:()=>S(!1),title:"Resident Details",children:j&&t.jsx(xe,{person:j})}),t.jsx(Ce,{isOpen:ee,onClose:()=>{g(!1)},onConfirm:re,residentId:D,title:"Confirm Removal",message:"Are you sure you want to remove resident from this household? This action cannot be undone.",buttonLabel:"I UNDERSTAND, REMOVE"})]})}export{Lt as default};
