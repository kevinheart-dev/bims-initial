import{j as e,r as u,K as ie,m as ne,a as F}from"./app-CSbLTV9t.js";import"./sidebar-EM1pc_Vu.js";import"./avatar-DBnd5X0z.js";import"./dropdown-menu-DsAxoPEU.js";import{u as re}from"./useAppUrl-CCPDQKWJ.js";import"./breadcrumb-BysmSHHT.js";import{X as D}from"./x-DSSMIW7T.js";import{P as oe,M as le}from"./phone-BqftDXwE.js";import{B as M}from"./constants-CQOY_faM.js";import me from"./SidebarModal-Ca0ENWih.js";import de from"./PersonDetailContent-BL527x7d.js";import{P as ce}from"./plus-CfpSO3j1.js";import{I as P}from"./InputField-B1L9QxNV.js";import{D as X}from"./DropdownInputField-D-lPqSgr.js";import{Y as B}from"./YearDropdown-DByzXVWN.js";import{I as pe}from"./InputLabel-D9dJg9rZ.js";import{I as m}from"./InputError-BCqWxJV0.js";import{S as C}from"./SelectField-7y4sEYBE.js";import{u as xe}from"./handleResidentChange-Bj7ATBPS.js";import ue from"./EditOfficialForm-BQJAZkYL.js";import{T as he}from"./textarea-Bqc0VVhC.js";import{t as N}from"./index-BKWT8n_e.js";import{I as ge,a as fe}from"./index-k6Ra7WmB.js";import{u as be}from"./useQuery-CDQnuoFr.js";import"./button-Baqcf9KW.js";import"./clsx-B-dksMZM.js";import"./utils-CkmPJWYF.js";import"./input-HZV2GfRj.js";import"./index-BWMtPXXG.js";import"./index-CLKsPuj0.js";import"./floating-ui.react-dom-DHVDvaGl.js";import"./skeleton-C3jJoeQy.js";import"./tooltip-b0GAWXCC.js";import"./createLucideIcon-K65SoRPX.js";import"./check-xGOvrYiq.js";import"./chevron-right-ZDo9j4tz.js";import"./iconBase-DIY0yPu9.js";import"./index-Bw3HOa7F.js";import"./index-BqPLuFbr.js";import"./heart-pulse-CgKjARwL.js";const je=({id:c,name:p,position:_,purok:h,term:O,phone:w,email:b,image:g,onView:j,onDelete:k,onEdit:v})=>e.jsxs("div",{className:"relative w-full max-w-[260px] sm:max-w-[300px] md:max-w-[320px] bg-white rounded-xl shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-transform duration-300 hover:scale-105",children:[e.jsx("button",{onClick:()=>k(c),className:"absolute top-2 right-2 bg-black/20 hover:bg-black/40 text-white rounded-full p-1 transition-colors duration-200",title:"Delete",children:e.jsx(D,{className:"w-3 h-3 sm:w-5 sm:h-5"})}),e.jsx("div",{className:"w-full h-[140px] sm:h-[160px] md:h-[180px] overflow-hidden",children:e.jsx("img",{src:g instanceof File?URL.createObjectURL(g):g?`/storage/${g}`:"/images/default-avatar.jpg",alt:"Official Image",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"px-3 py-2",children:[e.jsx("h2",{className:"text-sm sm:text-base font-bold text-gray-900 truncate",children:p}),e.jsx("p",{className:"text-blue-700 font-semibold text-xs sm:text-sm",children:_}),e.jsxs("p",{className:"text-gray-500 text-[9px] sm:text-[10px]",children:["Designation: Purok ",h]}),e.jsxs("p",{className:"text-gray-500 text-[9px] sm:text-[10px] mb-1",children:["Term: ",O]}),e.jsxs("div",{className:"space-y-1 text-[9px] sm:text-xs",children:[w&&e.jsxs("p",{className:"flex items-center space-x-2 overflow-hidden",children:[e.jsx(oe,{className:"text-blue-600 w-3.5 h-3.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-600 truncate",children:w})]}),b&&e.jsxs("p",{className:"flex items-center space-x-2 overflow-hidden",children:[e.jsx(le,{className:"text-blue-600 w-3.5 h-3.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-600 truncate",children:b})]})]}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{onClick:()=>v(c),className:"flex-1 border border-blue-600 text-blue-600 hover:bg-blue-50 text-xs sm:text-xs font-semibold py-1 rounded-lg transition-colors duration-200",children:"Edit Profile"}),e.jsx("button",{onClick:()=>j(c),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white text-xs sm:text-xs font-semibold py-1 rounded-lg transition-colors duration-200",children:"View Profile"})]})]})]}),_e=({onAdd:c})=>e.jsxs("div",{className:"fixed bottom-6 right-6 flex items-center z-50 group",children:[e.jsx("span",{className:`absolute right-16 bg-gray-800 text-white text-sm px-3 py-1
                           rounded-md opacity-0 group-hover:opacity-100
                           transition-opacity duration-200 whitespace-nowrap shadow-md`,children:"Add Barangay Official"}),e.jsx("button",{onClick:c,className:`w-14 h-14 bg-blue-600 hover:bg-blue-700 text-white
                           rounded-full flex items-center justify-center
                           shadow-xl hover:shadow-2xl
                           transition-transform duration-200 hover:scale-110`,children:e.jsx(ce,{className:"w-6 h-6"})})]}),ve=({isOpen:c,onClose:p,title:_,children:h})=>c?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:p}),e.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-lg mx-4 animate-fadeIn",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:_}),e.jsx("button",{onClick:p,className:"text-gray-500 hover:text-gray-700",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 overflow-y-auto max-h-[80vh]",children:h})]})]}):null,dt=()=>{const[c,p]=u.useState(!1),[_,h]=u.useState(!1),[O,w]=u.useState(!1),[b,g]=u.useState(null),[j,k]=u.useState(null),v=re(),f=ie().props;f==null||f.success;const S=(f==null?void 0:f.error)??null,y=f.errors??{},{data:o,isLoading:ye,isError:Ne,refetch:L}=be({queryKey:["barangay_officials"],queryFn:async()=>{const{data:t}=await F.get(`${v}/barangay_official`);return t},keepPreviousData:!0,staleTime:1e3*60*5}),U=(o==null?void 0:o.officials)??[],I=(o==null?void 0:o.residents)??[],V=(o==null?void 0:o.puroks)??[],Y=(o==null?void 0:o.activeterms)??[],{data:n,setData:i,post:R,errors:l,processing:E,reset:q,clearErrors:z}=ne({resident_name:"",resident_id:"",resident_image:"",position:"",designations:[],term:"",contact_number:"",email:"",appointment_type:"",appointted_by:"",appointment_reason:"",remarks:"",official_id:"",_method:void 0}),x=t=>{i(t.target.name,t.target.value)},K=xe(I,i),G=async t=>{try{const a=await F.get(`${v}/resident/showresident/${t}`);g(a.data.resident),p(!0)}catch(a){console.error("Error fetching resident details:",a)}},A=(t,a,s,r)=>{const d=[...n[r]||[]];d[a]={...d[a],[s]:t.target.value},i(r,d)},H=()=>{i("designations",[...n.designations||[],{}])},Q=t=>{const a=[...n.designations||[]];a.splice(t,1),i("designations",a),N.warning("Designation removed.",{duration:2e3})},J=()=>{h(!0),p(!0)},W=async t=>{try{const s=(await F.get(`${v}/barangay_official/officialsinfo/${t}`)).data.official;k(s),console.log(s),i("resident_id",s.resident.id||""),i("resident_name",`${s.resident.firstname} ${s.resident.middlename} ${s.resident.lastname} ${s.resident.suffix??""}`),i("contact_number",s.resident.contact_number||""),i("email",s.resident.email||""),i("position",s.position||""),i("designations",(s.designation||[]).map(r=>({designation:r.purok_id||"",term_start:r.started_at||"",term_end:r.ended_at||""}))),i("term",s.term.id?s.term.id.toString():""),i("resident_image",s.resident.resident_picture_path||""),i("appointment_type",s.appointment_type||""),s.appointment_type==="appointed"?(i("appointted_by",s.appointted_by?s.appointted_by.toString():""),i("appointment_reason",s.appointment_reason||""),i("remarks",s.remarks||"")):(i("appointted_by",""),i("appointment_reason",""),i("remarks","")),i("_method","PUT"),i("official_id",s.id),p(!0),h(!0)}catch(a){console.error("There was an error fetching the data!",a)}},Z=Object.entries(M).map(([t,a])=>({label:a,value:t.toString()})),ee=Array.from(new Set(V)).map(t=>({label:"Purok "+t,value:t.toString()})),T=I.map(t=>({label:`${t.firstname} ${t.middlename} ${t.lastname} ${t.suffix??""}`,value:t.id.toString()})),te=Y.map(t=>({label:`${t.term_start} - ${t.term_end}`,value:t.id.toString()}));u.useEffect(()=>{S&&N.error(S,{description:"Please check the form for errors.",duration:3e3,closeButton:!0})},[S]),u.useEffect(()=>{y!=null&&y.position&&N.error(y.position,{description:"Please check the form for errors.",duration:3e3,closeButton:!0})},[y]),u.useEffect(()=>{n.appointment_type!=="appointed"&&i(t=>({...t,appointted_by:"",appointment_reason:""}))},[n.appointment_type]);const $=()=>{L(),p(!1),g(null),k(null),h(!1),q(),z()},se=t=>{t.preventDefault(),R(route("barangay_official.store"),{onError:a=>{console.error("Validation Errors:",a);const s=Object.values(a);N.error("Validation Error",{description:e.jsx("ul",{children:s.map((r,d)=>e.jsx("li",{children:r},d))})})},onSuccess:()=>{$()}})},ae=t=>{t.preventDefault(),R(route("barangay_official.update",n.official_id),{onError:a=>{console.error("Validation Errors:",a);const s=Object.values(a);N.error("Validation Error",{description:e.jsx("ul",{children:s.map((r,d)=>e.jsx("li",{children:r},d))})})},onSuccess:()=>{$()}})};return e.jsxs("div",{className:"p-2 md:px-2 md:py-2",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 p-4",children:U.map(t=>{var a,s,r,d;return e.jsx(je,{id:t.resident.id,name:`${t.resident.firstname} ${t.resident.lastname}`,position:M[t.position],purok:((s=(a=t.active_designations[0])==null?void 0:a.purok)==null?void 0:s.purok_number)||"N/A",term:`${((r=t.term)==null?void 0:r.term_start)||"0000"} â€“ ${((d=t.term)==null?void 0:d.term_end)||"0000"}`,phone:t.resident.contact_number,email:t.resident.email,image:t.resident.resident_picture_path,onView:()=>G(t.resident.id),onEdit:()=>W(t.id)},t.id)})}),e.jsx(_e,{onAdd:J}),e.jsxs(me,{isOpen:c,onClose:()=>$(),title:b?"Resident Details":j?"Edit Official":"Add Official",children:[b&&e.jsx(de,{person:b}),_&&e.jsxs("form",{onSubmit:j?ae:se,className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-2xl font-medium text-gray-700",children:"Barangay Officials Information"}),e.jsx("p",{className:"text-sm text-gray-500 mb-8",children:"Please provide details about the elected and appointed officials serving in the barangay, including their positions, terms, and responsibilities."}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"flex flex-col  items-center",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(pe,{htmlFor:"resident_image",value:"Resident Photo"}),e.jsx("img",{src:n.resident_image instanceof File?URL.createObjectURL(n.resident_image):n.resident_image?`/storage/${n.resident_image}`:"/images/default-avatar.jpg",alt:"Resident Image",className:"w-64 h-64 object-cover rounded-full border border-gray-200"})]}),e.jsx(m,{message:l.resident_image,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col gap-4 flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"resident_name",children:"Full Name"}),e.jsx(X,{id:"resident_name",name:"resident_name",placeholder:"Enter full name",value:n.resident_name||"",onChange:t=>K(t),items:T}),e.jsx(m,{message:l.resident_id,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"position",children:"Position"}),e.jsx(C,{id:"position",name:"position",value:n.position,onChange:x,items:Z,children:e.jsx("option",{value:"",disabled:!0,children:"Select barangay position"})}),e.jsx(m,{message:l.position,className:"mt-2"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",htmlFor:"designation",children:"Phone Number"}),e.jsx(P,{id:"contact_number",name:"contact_number",type:"text",placeholder:"09XXXXXXXXX",value:n.contact_number||"",onChange:x,disabled:!0}),e.jsx(m,{message:l.contact_number,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",htmlFor:"designation",children:"Email"}),e.jsx(P,{id:"email",name:"email",type:"email",placeholder:"test@gmail.com",value:n.email||"",onChange:x,disabled:!0}),e.jsx(m,{message:l.email,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid  grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"term",children:"Official Term"}),e.jsx(C,{id:"term",name:"term",placeholder:"Select term of offcial",value:n.term||"",onChange:x,items:te}),e.jsx(m,{message:l.term,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"appointment_type",children:"Appointment Type"}),e.jsx(C,{id:"appointment_type",name:"appointment_type",value:n.appointment_type||"",onChange:x,items:[{label:"Elected",value:"elected"},{label:"Appointed",value:"appointed"},{label:"Succession",value:"succession"}]}),e.jsx(m,{message:l.appointment_type,className:"mt-2"})]})]}),["barangay_kagawad","sk_kagawad"].includes(n.position)&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[(n.designations||[]).map((t,a)=>e.jsxs("div",{className:"items-start pr-8 rounded-md relative",children:[e.jsxs("div",{children:[e.jsx(C,{id:"designation",name:"designation",label:"Designation",value:t.designation||"",onChange:s=>A(s,a,"designation","designations"),items:ee.map((s,r)=>({...s,key:r}))}),e.jsx(m,{message:l[`designations.${a}.designation`],className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(B,{id:"term_start",name:"term_start",label:"Term Start",value:t.term_start||"",onChange:s=>A(s,a,"term_start","designations"),className:"w-full"}),e.jsx(m,{message:l[`designations.${a}.term_start`],className:"mt-2"})]}),e.jsx("div",{children:e.jsx(B,{id:"term_end",name:"term_end",label:"Term Ended",value:t.term_end||"",onChange:s=>A(s,a,"term_end","designations"),className:"w-full"})}),e.jsx("button",{type:"button",onClick:()=>Q(a),className:"absolute top-1 right-2 flex items-center gap-1 text-2xl text-red-400 hover:text-red-800 font-medium mt-1 mb-5 transition-colors duration-200",title:"Remove",children:e.jsx(ge,{})})]},a)),e.jsxs("button",{type:"button",onClick:()=>H(),className:"flex items-center text-blue-600 hover:text-blue-800 text-sm mt-2",title:"Add Designation",children:[e.jsx(fe,{className:"text-4xl"}),e.jsx("span",{className:"ml-1",children:"Add Designation"})]})]}),n.appointment_type==="appointed"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 items-start",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"appointted_by",children:"Appointed By"}),e.jsx(X,{id:"appointted_by",name:"appointted_by",placeholder:"Enter full name",value:n.appointted_by||"",onChange:t=>x(t),items:T}),e.jsx(m,{message:l.appointted_by,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"remarks",children:"Remarks"}),e.jsx(P,{id:"remarks",name:"remarks",value:n.remarks,onChange:x}),e.jsx(m,{message:l.remarks,className:"mt-2"})]}),e.jsxs("div",{className:"grid col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"appointment_reason",children:"Appointment Reason"}),e.jsx(he,{id:"appointment_reason",name:"appointment_reason",value:n.appointment_reason,onChange:x}),e.jsx(m,{message:l.appointment_reason,className:"mt-2"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",disabled:E,children:j?E?"Updating...":"Update":E?"Saving...":"Save"})})]})]}),e.jsx(ve,{isOpen:O,onClose:()=>w(!1),title:"Edit Barangay Official",children:j&&e.jsx(ue,{})})]})};export{dt as default};
