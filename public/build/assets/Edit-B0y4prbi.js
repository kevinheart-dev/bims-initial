import{r as p,m as io,j as _,K as ho,L as to}from"./app-NONmr2q7.js";import po from"./BreadcrumbsHeader-D8tiVWTI.js";import"./index-CvNDV1A-.js";import{B as fo}from"./button-B60YSiq3.js";import{S as go,a as bo,b as no}from"./Section3-CuCek86p.js";import{S as ro}from"./Section4-BWk6oTHg.js";import{S as yo}from"./Section5-vhfRrkmt.js";import{C as vo}from"./Checkbox-DROMcRNl.js";import"./index-WVyhkiLH.js";import{S as xo}from"./AdminLayout-CAq8111M.js";import"./breadcrumb-CDexVwyR.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./chevron-right-DBIVXYWk.js";import"./createLucideIcon-BjswQhwn.js";import"./sidebar-CwuwXzjO.js";import"./input-BFFeM9xD.js";import"./index-RBJTYTCy.js";import"./floating-ui.react-dom-jFzDCjY_.js";import"./x-sF-KpabD.js";import"./skeleton-uAG2kVnC.js";import"./tooltip-Cn5LYVv3.js";import"./InputField-DYlBd11g.js";import"./InputError-BaM3HfGO.js";import"./InputLabel-BLUQeTh-.js";import"./DropdownInputField-dSSBcj-O.js";import"./RadioGroup-BiK_18OU.js";import"./SelectField-CNsQEAgs.js";import"./YearDropdown-xs-xt_LK.js";import"./index-D52x4y4z.js";import"./iconBase-DbCAZpIL.js";import"./useAppUrl-C81wl3Q_.js";import"./nav-user-D01iDzqt.js";import"./avatar-CuINGoVe.js";import"./dropdown-menu-4X7q6_gv.js";import"./check-DPirRqHD.js";import"./users-round-BQO22qvz.js";import"./heart-pulse-t-V8Bniw.js";import"./chevron-up-K4GnFQxP.js";const So=({puroks:w,occupationTypes:y=null,streets:v=null,households:t=null,barangays:r=null,resident:o})=>{var j,k,s,N,z,A,B,M,D,E,I,R,C,P,q,F,H,L,O,T,Y,G,K,U,V,J,Q,W,X,Z,$;const f=p.useCallback(a=>{if(!a)return 0;const m=new Date(a),c=new Date;let i=c.getFullYear()-m.getFullYear();const h=c.getMonth()-m.getMonth();return(h<0||h===0&&c.getDate()<m.getDate())&&i--,i},[]);Object.entries(r).map(([a,m])=>({label:m,value:a}));const g=t==null?void 0:t.map(a=>({label:a.household.house_number.toString().padStart(4,"0")+" || "+a.lastname+"'s Residence",value:a.household.id.toString()}));familyHeads.map(a=>({label:[a.firstname,a.middlename,a.lastname,a.suffix].filter(Boolean).join(" "),value:a.id.toString()}));const x={resident_image:null,lastname:(o==null?void 0:o.lastname)||"",firstname:(o==null?void 0:o.firstname)||"",middlename:(o==null?void 0:o.middlename)||"",suffix:(o==null?void 0:o.suffix)||"",birthdate:(o==null?void 0:o.birthdate)||"",age:o?f(o.birthdate):0,birthplace:(o==null?void 0:o.birthplace)||"",civil_status:(o==null?void 0:o.civil_status)||"",sex:o!=null&&o.sex?o==null?void 0:o.sex.toString():"",gender:(o==null?void 0:o.gender)||"",maiden_name:(o==null?void 0:o.maiden_name)||"",citizenship:(o==null?void 0:o.citizenship)||"",religion:(o==null?void 0:o.religion)||"",ethnicity:(o==null?void 0:o.ethnicity)||"",employment_status:(o==null?void 0:o.employment_status)||"",contactNumber:(o==null?void 0:o.contact_number)||"",email:(o==null?void 0:o.email)||"",residency_type:(o==null?void 0:o.residency_type)||"",residency_date:(o==null?void 0:o.residency_date)||"",is_household_head:(o==null?void 0:o.is_household_head)||0,is_family_head:(o==null?void 0:o.is_family_head)||0,verified:0,purok_number:(o==null?void 0:o.purok_number)||null,purok_id:((j=o==null?void 0:o.street)==null?void 0:j.purok_id)||null,street_id:((k=o==null?void 0:o.street)==null?void 0:k.id)||null,street_name:((s=o==null?void 0:o.street)==null?void 0:s.street_name)||"",subdivision:((N=o==null?void 0:o.household)==null?void 0:N.subdivision)||"",housenumber:(()=>{const a=g.find(m=>{var c;return m.value===String((c=o==null?void 0:o.household)==null?void 0:c.id)});return(a==null?void 0:a.value)||""})(),housenumber_label:(()=>{const a=g.find(m=>{var c;return m.value===String((c=o==null?void 0:o.household)==null?void 0:c.id)});return(a==null?void 0:a.label)||""})(),household_id:(()=>{const a=g.find(m=>{var c;return m.value===String((c=o==null?void 0:o.household)==null?void 0:c.id)});return(a==null?void 0:a.value)||""})(),is_4ps_beneficiary:((z=o==null?void 0:o.social_welfare_profile)==null?void 0:z.is_4ps_beneficiary)!=null?o.social_welfare_profile.is_4ps_beneficiary.toString():null,is_solo_parent:((A=o==null?void 0:o.social_welfare_profile)==null?void 0:A.is_solo_parent)!=null?o.social_welfare_profile.is_solo_parent.toString():null,solo_parent_id_number:((B=o==null?void 0:o.social_welfare_profile)==null?void 0:B.solo_parent_id_number)||"",voter_id_number:((M=o==null?void 0:o.voting_information)==null?void 0:M.voter_id_number)||"",voting_status:((D=o==null?void 0:o.voting_information)==null?void 0:D.voting_status)||"",registered_voter:o!=null&&o.registered_voter?o==null?void 0:o.registered_voter.toString():"0",registered_barangay:((I=(E=o==null?void 0:o.voting_information)==null?void 0:E.registered_barangay_id)==null?void 0:I.toString())||null,has_vehicle:(R=o==null?void 0:o.vehicles)!=null&&R.length?1:0,vehicles:(o==null?void 0:o.vehicles)||[],educational_histories:Array.isArray(o==null?void 0:o.educational_histories)&&o.educational_histories.length?o.educational_histories.map(({educational_attainment:a,...m})=>({...m,education:a||""})):[],occupations:Array.isArray(o==null?void 0:o.occupations)&&o.occupations.length?o.occupations.map(a=>({...a,income:a.monthly_income||0,income_frequency:a.income_frequency||"monthly",work_arrangement:a.work_arrangement||""})):[],weight_kg:((C=o==null?void 0:o.medical_information)==null?void 0:C.weight_kg)||0,height_cm:((P=o==null?void 0:o.medical_information)==null?void 0:P.height_cm)||0,bmi:((q=o==null?void 0:o.medical_information)==null?void 0:q.bmi)||0,nutrition_status:((F=o==null?void 0:o.medical_information)==null?void 0:F.nutrition_status)||"",emergency_contact_name:((H=o==null?void 0:o.medical_information)==null?void 0:H.emergency_contact_name)||"",emergency_contact_number:((L=o==null?void 0:o.medical_information)==null?void 0:L.emergency_contact_number)||null,emergency_contact_relationship:((O=o==null?void 0:o.medical_information)==null?void 0:O.emergency_contact_relationship)||"",blood_type:((T=o==null?void 0:o.medical_information)==null?void 0:T.blood_type)||null,has_philhealth:((Y=o==null?void 0:o.medical_information)==null?void 0:Y.has_philhealth)!=null?o.medical_information.has_philhealth.toString():null,philhealth_number:((G=o==null?void 0:o.medical_information)==null?void 0:G.philhealth_id_number)||"",is_pwd:(o==null?void 0:o.is_pwd)!=null?o.is_pwd.toString():null,pwd_id_number:((K=o==null?void 0:o.medical_information)==null?void 0:K.pwd_id_number)||"",is_alcohol_user:((U=o==null?void 0:o.medical_information)==null?void 0:U.is_alcohol_user)!=null?o.medical_information.is_alcohol_user.toString():null,is_smoker:((V=o==null?void 0:o.medical_information)==null?void 0:V.is_smoker)!=null?o.medical_information.is_smoker.toString():null,livelihoods:Array.isArray(o==null?void 0:o.livelihoods)&&o.livelihoods.length?o.livelihoods.map(a=>({...a,income:a.income||a.monthly_income||0,income_frequency:a.income_frequency||"monthly",status:a.status||"active",is_main_livelihood:a.is_main_livelihood!=null?a.is_main_livelihood.toString():""})):[],disabilities:(o==null?void 0:o.disabilities)||[],relationship_to_head:((J=o==null?void 0:o.latestHouseholdResident)==null?void 0:J.relationship_to_head)||"",household_position:((Q=o==null?void 0:o.latestHouseholdResident)==null?void 0:Q.household_position)||"",name_of_head:"",is_pensioner:((W=o==null?void 0:o.senior_citizen)==null?void 0:W.is_pensioner)||"",living_alone:((X=o==null?void 0:o.senior_citizen)==null?void 0:X.living_alone)!=null?o.senior_citizen.living_alone.toString():null,osca_id_number:((Z=o==null?void 0:o.senior_citizen)==null?void 0:Z.osca_id_number)!=null?o.senior_citizen.osca_id_number.toString():null,pension_type:(($=o==null?void 0:o.senior_citizen)==null?void 0:$.pension_type)||"",_method:"PUT"},{data:l,setData:u,post:mo,errors:b}=io({...x}),_o=o!=null&&o.resident_picture_path?"/storage/"+o.resident_picture_path:null,uo=["female"].includes(l.gender)&&["married","widowed","Separated"].includes(l.civil_status);p.useMemo(()=>(t||[]).reduce((a,m)=>(a[String(m.household.id)]=m,a),{}),[t]);const S=p.useCallback((a,m,c,i)=>{const h=[...l[i]||[]];h[m]={...h[m],[c]:a.target.value},u(i,h)},[l,u]);p.useEffect(()=>{l.birthdate&&u("age",f(l.birthdate))},[l.birthdate,f,u]),p.useEffect(()=>{if(l.weight_kg>0&&l.height_cm>0){const a=l.height_cm/100,m=l.weight_kg/(a*a),c=parseFloat(m.toFixed(2));let i="";m<16?i="severly_underweight":m<18.5?i="underweight":m<25?i="normal":m<30?i="overweight":i="obese",u(h=>({...h,bmi:c,nutrition_status:i}))}else u(a=>({...a,bmi:0,nutrition_status:""}))},[l.weight_kg,l.height_cm,u]),p.useEffect(()=>{var i,h,e,d,oo,ao,lo;if(!l.housenumber)return;const a=(t||[]).find(n=>String(n.household_id)===String(l.household_id)&&(n.is_household_head===1||n.is_household_head===!0));if(!a)return;const m=[a.firstname,a.middlename,a.lastname,a.suffix].filter(Boolean).join(" "),c={household_id:a.household.household_id??a.household_id,street_id:a.household.street_id,street_name:((h=(i=a.household)==null?void 0:i.street)==null?void 0:h.street_name)||"",purok_id:((d=(e=a.household)==null?void 0:e.purok)==null?void 0:d.id)||((oo=a.household)==null?void 0:oo.purok_id)||"",purok_number:((lo=(ao=a.household)==null?void 0:ao.purok)==null?void 0:lo.purok_number)||"",name_of_head:m};u(n=>({...n,...c}))},[l.housenumber,t,u]);const co=a=>{a.preventDefault(),mo(route("resident.update",o.id),{onError:m=>{console.log(m)}})};return _.jsx("div",{children:_.jsxs("form",{onSubmit:co,children:[_.jsx(go,{data:l,setData:u,handleArrayValues:S,errors:b,showMaidenMiddleName:uo,barangays:r,existingImagePath:_o}),_.jsx(bo,{data:l,setData:u,errors:b,handleArrayValues:S}),_.jsx(no,{data:l,setData:u,errors:b,occupationTypes:y}),_.jsx(ro,{data:l,setData:u,errors:b}),_.jsx(yo,{data:l,setData:u,handleArrayValues:S,errors:b,puroks:w,streets:v,households:t}),_.jsx("section",{className:"space-y-4 border border-gray-200 p-4 rounded-md my-4",children:_.jsxs("label",{className:"flex items-start space-x-2",children:[_.jsx(vo,{name:"verified",value:l.verified,checked:l.verified===1||l.verified===!0,onChange:a=>u("verified",a.target.checked?1:0)}),_.jsx("span",{className:"text-sm text-gray-700",children:"I hereby certify that the above information is true and correct to the best of my knowledge. I understand that for the Barangay to carry out its mandate pursuant to Section 394(d)(6) of the Local Government Code of 1991, it must necessarily process my personal information for easy identification of inhabitants, as a tool in planning, and as an updated reference for the number of inhabitants in the Barangay. Therefore, I grant my consent and recognize the authority of the Barangay to process my personal information, subject to the provisions of the Philippine Data Privacy Act of 2012."})]})}),_.jsx("div",{className:"flex w-full justify-center items-center mt-7",children:_.jsx(fo,{className:"w-40",type:"submit",disabled:l.verified===0,children:"Submit"})})]})})};function ca({auth:w,puroks:y,occupationTypes:v,streets:t,households:r,barangays:o,resident:f=null,familyHeads:g}){const x=[{label:"Residents Information",showOnMobile:!1},{label:"Residents Table",href:route("resident.index"),showOnMobile:!1},{label:"Edit Resident",showOnMobile:!0}],l=ho().props,u=(l==null?void 0:l.error)??null;return _.jsxs(xo,{children:[_.jsx(to,{title:"Resident Dashboard"}),_.jsx(po,{breadcrumbs:x}),_.jsx("div",{children:_.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6",children:_.jsx("div",{className:"overflow-hidden bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 my-8",children:_.jsxs("div",{className:" my-2 p-5",children:[u&&_.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:u}),_.jsx(So,{puroks:y,occupationTypes:v,streets:t,households:r,barangays:o,resident:f.data,familyHeads:g})]})})})})]})}export{ca as default};
