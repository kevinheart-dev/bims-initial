import{K as ne,r as l,m as ce,j as t,L as de,S as T,a as me}from"./app-OMiIBAVv.js";import{S as ue}from"./AdminLayout-CUYq8DRk.js";import{B as I}from"./button-DSR4zr8t.js";import{I as pe}from"./input-BGuCCM3F.js";import he from"./BreadcrumbsHeader-D7yXDAqZ.js";import{t as _,T as xe}from"./index-0Qv22I-m.js";import ve from"./DynamicTable-UkXv7no2.js";import fe from"./ActionMenu-BwZQbtv1.js";import{a4 as be,a5 as ge,ac as _e}from"./constants-iESbBslm.js";import ye from"./SidebarModal-BhCVnGdX.js";import je from"./DynamicTableControls-D0m5fsZs.js";import{F as Se}from"./FillterToggle-DNCt5F0M.js";import{u as we}from"./handleResidentChange-oP0FMrcp.js";import{u as Ne}from"./useAppUrl-D_iSPAaw.js";import ke from"./DeleteConfirmationModal-TJ1uBlKB.js";import Ee from"./VehicleForm-YvmK_wLK.js";import{E as Ce}from"./ExportButton-D1HLyQQo.js";import{c as De}from"./createLucideIcon-Axl_0YCz.js";import{S as Ve}from"./search-B5GIhMYd.js";import{L as Te}from"./list-plus-BMoEcxBa.js";import{S as Ie}from"./square-pen-CIUQNKLN.js";import{T as Ae}from"./trash-2-jR1sYQPd.js";import"./sidebar-8I0oMIHa.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-CI6SsBKC.js";import"./index-BLQZ4u8d.js";import"./floating-ui.react-dom-CMRH_ZRG.js";import"./x-CWRGpm6F.js";import"./skeleton-B3ns0wAt.js";import"./tooltip-DovJGv4D.js";import"./nav-user-CHo7Aeqf.js";import"./avatar-EoKRnGG_.js";import"./dropdown-menu-Bvu9yf_7.js";import"./check-CuPlmUjy.js";import"./chevron-right-Cy23RFOt.js";import"./users-round-DM5XvS4t.js";import"./heart-pulse-BEye5CQy.js";import"./chevron-up-aIKK6lnp.js";import"./breadcrumb-BupgMzbl.js";import"./ellipsis-PuzZ1_TO.js";import"./index-CK7UpZTr.js";import"./iconBase-DPQdzrdi.js";import"./DropdownInputField-BkfrznIy.js";import"./InputError-LtgWhWIb.js";import"./InputField-BN9Kcp6u.js";import"./InputLabel-Cqcva6ji.js";import"./RadioGroup-Bx2v-oud.js";import"./rotate-ccw-X1iZFrTN.js";import"./move-right-OsZnL4gk.js";import"./file-output-BYH2ausi.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],Me=De("car",Le);function Ps({vehicles:A,vehicle_types:L,puroks:M,queryParams:O,residents:y}){const a=O||{},P=[{label:"Residents Information",showOnMobile:!1},{label:"Vehicles",showOnMobile:!0}],R=Ne(),o=ne().props,d=(o==null?void 0:o.success)??null,m=(o==null?void 0:o.error)??null,[F,u]=l.useState(null),[p,j]=l.useState(null),[$,h]=l.useState(!1),[S,U]=l.useState(null),[w,B]=l.useState(a.name??""),[H,x]=l.useState(!1),{data:n,setData:c,post:N,errors:q,reset:k,clearErrors:X}=ce({resident_id:null,resident_name:"",resident_image:null,birthdate:null,purok_number:null,has_vehicle:null,vehicles:[[]],vehicle_id:null,_method:void 0}),z=we(y,c),K=(e,s,r,i)=>{const g=[...n[i]||[]];g[s]={...g[s],[r]:e.target.value},c(i,g)},G=e=>{e.preventDefault(),v("name",w)},v=(e,s)=>{s&&s.trim()!==""?a[e]=s:delete a[e],a.page&&delete a.page,T.get(route("vehicle.index",a))},Y=(e,s)=>{s.key==="Enter"&&v(e,s.target.value)},Q=()=>{c("vehicles",[...n.vehicles||[],{}])},J=e=>{const s=[...n.vehicles||[]];s.splice(e,1),c("vehicles",s),_.warning("Vehicle removed.",{duration:2e3})},f=[{key:"id",label:"Vehicle ID"},{key:"name",label:"Owner Name"},{key:"vehicle_type",label:"Vehicle Type"},{key:"vehicle_class",label:"Class"},{key:"usage_status",label:"Usage"},{key:"is_registered",label:"Is Registered?"},{key:"purok_number",label:"Purok Number"},{key:"actions",label:"Actions"}],[E,W]=l.useState(f.map(e=>e.key)),[Oe,Pe]=l.useState(!0),[Re,Fe]=l.useState(!1),b=Object.entries(a||{}).some(([e,s])=>["purok","v_type","v_class","usage"].includes(e)&&s&&s!==""),[C,D]=l.useState(b);l.useEffect(()=>{D(b)},[b]);const Z=()=>D(e=>!e),ee={id:e=>{var s,r;return((r=(s=e.vehicles)==null?void 0:s[0])==null?void 0:r.id)??"—"},name:e=>t.jsxs("span",{children:[e.firstname," ",e.middlename??""," ",e.lastname," ",e.suffix??""]}),vehicle_type:e=>{var s,r;return t.jsx("span",{className:"capitalize",children:((r=(s=e.vehicles)==null?void 0:s[0])==null?void 0:r.vehicle_type)??"—"})},vehicle_class:e=>{var s;return(s=e.vehicles)!=null&&s[0]?be[e.vehicles[0].vehicle_class]:"—"},usage_status:e=>{var i;const s=(i=e.vehicles)==null?void 0:i[0];if(!s)return"—";const r=ge[s.usage_status];return t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${_e[s.usage_status]}`,children:r})},is_registered:e=>{var r,i;const s=(i=(r=e.vehicles)==null?void 0:r[0])==null?void 0:i.is_registered;return s===void 0?"—":s?t.jsx("span",{className:"text-green-600 font-medium",children:"Yes"}):t.jsx("span",{className:"text-gray-500 font-medium",children:"No"})},purok_number:e=>e.purok_number,actions:e=>{var r,i;const s=(i=(r=e.vehicles)==null?void 0:r[0])==null?void 0:i.id;return s?t.jsx(fe,{actions:[{label:"Edit",icon:t.jsx(Ie,{className:"w-4 h-4 text-green-500"}),onClick:()=>ie(s)},{label:"Delete",icon:t.jsx(Ae,{className:"w-4 h-4 text-red-600"}),onClick:()=>ae(s)}]}):null}},se=()=>{u("add"),x(!0)},te=y.map(e=>({label:`${e.firstname} ${e.middlename} ${e.lastname} ${e.suffix??""}`,value:e.id.toString()})),re=e=>{e.preventDefault(),N(route("vehicle.store"),{onError:s=>console.log(s)})},le=e=>{e.preventDefault(),N(route("vehicle.update",n.vehicle_id),{onError:s=>console.log(s)})},V=()=>{x(!1),u(null),j(null),k(),X()},ie=async e=>{u("add");try{const r=(await me.get(`${R}/vehicle/details/${e}`)).data.vehicle;j(r),c({resident_id:r.resident.id,resident_name:`${r.resident.firstname} ${r.resident.middlename??""} ${r.resident.lastname}`,resident_image:r.resident.image??null,birthdate:r.resident.birthdate??null,purok_number:r.resident.purok_number??null,vehicles:[{usage_status:r.usage_status||"",vehicle_class:r.vehicle_class||"",vehicle_status:r.vehicle_status||"",vehicle_type:r.vehicle_type||"",is_registered:r.is_registered?r.is_registered.toString():""}],_method:"PUT",vehicle_id:r.id}),x(!0)}catch(s){console.error("Error fetching occupation details:",s)}},ae=e=>{U(e),h(!0)},oe=()=>{T.delete(route("vehicle.destroy",S)),h(!1)};return l.useEffect(()=>{d&&(V(),_.success(d,{description:"Operation successful!",duration:3e3,closeButton:!0})),o.success=null},[d]),l.useEffect(()=>{m&&_.error(m,{description:"Operation failed!",duration:3e3,closeButton:!0}),o.error=null},[m]),t.jsxs(ue,{children:[t.jsx(de,{title:"Vehicles"}),t.jsxs("div",{children:[t.jsx(xe,{richColors:!0}),t.jsx(he,{breadcrumbs:P}),t.jsx("div",{className:"p-2 md:p-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:t.jsx(Me,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Vehicle Records"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Manage community vehicle data including ownership, type, and usage. Use the tools below to search, filter, or export vehicle records."})]})]})}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[t.jsx(je,{allColumns:f,visibleColumns:E,setVisibleColumns:W,showFilters:C,toggleShowFilters:Z}),t.jsx(Ce,{url:"report/export-vehicles-excel",queryParams:a,label:"Export Vehicles as XLSX"})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:G,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(pe,{type:"text",placeholder:"Search Owners Name",value:w,onChange:e=>B(e.target.value),onKeyDown:e=>Y("name",e),className:"w-full"}),t.jsx("div",{className:"relative group z-50",children:t.jsx(I,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(Ve,{})})})]}),t.jsx("div",{className:"relative group z-50",children:t.jsx(I,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",onClick:se,type:"button",children:t.jsx(Te,{})})})]})]}),C&&t.jsx(Se,{queryParams:a,searchFieldName:v,visibleFilters:["purok","v_type","v_class","usage"],vehicle_types:L,puroks:M,showFilters:!0,clearRouteName:"vehicle.index",clearRouteParams:{}}),t.jsx(ve,{passedData:A,allColumns:f,columnRenderers:ee,queryParams:a,visibleColumns:E,showTotal:!0}),t.jsx(ye,{isOpen:H,onClose:V,title:p?"Edit Vehicle Details":"Add Vehicles",children:F==="add"&&t.jsx("div",{className:"w-full rounded-xl border border-white/20 bg-white/10 backdrop-blur-md shadow-lg text-sm text-black p-4 space-y-4",children:t.jsx(Ee,{data:n,errors:q,vehicleDetails:p,residentsList:te,handleResidentChange:z,handleArrayValues:K,addVehicle:Q,removeVehicle:J,reset:k,onSubmit:p?le:re})})}),t.jsx(ke,{isOpen:$,onClose:()=>{h(!1)},onConfirm:oe,residentId:S})]})})})]})]})}export{Ps as default};
