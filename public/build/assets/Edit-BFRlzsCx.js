import{K as T,m as b,r as C,j as e,L as A}from"./app-CAI_Xi7A.js";import D from"./BreadcrumbsHeader-u3_h05-q.js";import{I as m}from"./InputError-BiiI55GW.js";import{I as j}from"./InputField-D-e3hYpU.js";import{I as u}from"./InputLabel-BT6mFndR.js";import{B as R}from"./button-B2e2mbbx.js";import{S as M}from"./AdminLayout-BBkvF7AB.js";import{S as O}from"./SelectField-CRE2x-18.js";import{T as p}from"./textarea-CHkrgSs2.js";import{P as f}from"./ParticipantSection-CrkPfvug.js";import{t as y,T as P}from"./index-Cgx8JViO.js";import{c as $}from"./createLucideIcon-BHvbubz-.js";import{R as F}from"./rotate-ccw-BInQUkzA.js";import{S as H}from"./save-B9KZggfv.js";import"./breadcrumb-VciwGQE3.js";import"./chevron-right-BSGyrecN.js";import"./sidebar-a1aNtWVV.js";import"./input-CfVkjq7t.js";import"./index-ojRVqHRA.js";import"./index-DAHXmnmd.js";import"./floating-ui.react-dom-Ch_BF0uH.js";import"./x-CsjTKPAO.js";import"./skeleton-BEwS4pRR.js";import"./tooltip-jYooasFz.js";import"./clsx-B-dksMZM.js";import"./nav-user-C-vfih3_.js";import"./avatar-DoNt6kB4.js";import"./dropdown-menu-PvhDvCG0.js";import"./check-BryJKuDK.js";import"./useAppUrl-DLWW32FJ.js";import"./users-round-CdqN5C7N.js";import"./chevron-up-BQycqutk.js";import"./index-C5dnbsTc.js";import"./iconBase-DikqhLuj.js";import"./DropdownInputField-8xLI6fmq.js";import"./constants-D2Bk5JvR.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],V=$("pen-line",K);function Re({residents:E,blotter_details:s}){const S=[{label:"Katarungang Pambarangay",showOnMobile:!1},{label:"Blotter Reports",href:route("blotter_report.index"),showOnMobile:!1},{label:"Edit Blotter Report",showOnMobile:!0}],t=T().props,x=(t==null?void 0:t.success)??null,c=(t==null?void 0:t.error)??null,h=(a,g)=>(a==null?void 0:a.filter(n=>n.role_type===g).map(n=>{var d,l,N,w,k;return{resident_id:n.resident_id||"",resident_name:n.name||n.display_name||"",birthdate:((d=n.resident)==null?void 0:d.birthdate)||"",sex:((l=n.resident)==null?void 0:l.sex)||"",purok_number:((N=n.resident)==null?void 0:N.purok_number)||"",email:((w=n.resident)==null?void 0:w.email)||"",contact_number:((k=n.resident)==null?void 0:k.contact_number)||"",notes:n.notes||""}}))||[{resident_id:""}],{data:r,setData:i,post:I,errors:o,reset:L}=b({type_of_incident:(s==null?void 0:s.type_of_incident)??"",narrative_details:(s==null?void 0:s.narrative_details)??"",actions_taken:(s==null?void 0:s.actions_taken)??"",report_status:(s==null?void 0:s.report_status)??"",location:(s==null?void 0:s.location)??"",resolution:(s==null?void 0:s.resolution)??"",recommendations:(s==null?void 0:s.recommendations)??"",incident_date:(s==null?void 0:s.incident_date)??"",recorded_by:(s==null?void 0:s.recorded_by)??null,complainants:h(s==null?void 0:s.participants,"complainant"),respondents:h(s==null?void 0:s.participants,"respondent"),witnesses:h(s==null?void 0:s.participants,"witness"),blotter_id:s.id,_method:"PUT"}),B=a=>{a.preventDefault(),I(route("blotter_report.update",r.blotter_id),{onError:g=>{const n=Object.values(g).map((d,l)=>`<div key=${l}> ${d}</div>`);y.error("Validation Error",{description:e.jsx("div",{dangerouslySetInnerHTML:{__html:n.join("")}}),duration:4e3,closeButton:!0})}})},v=E.map(a=>({value:a.id,label:`${a.firstname} ${a.middlename?a.middlename+" ":""}${a.lastname}${a.suffix?", "+a.suffix:""}`,...a}));return C.useEffect(()=>{x&&(handleModalClose(),y.success(x,{description:"Operation successful!",duration:3e3,closeButton:!0})),t.success=null},[x]),C.useEffect(()=>{c&&y.error(c,{description:"Operation failed!",duration:3e3,closeButton:!0}),t.error=null},[c]),e.jsxs(M,{children:[e.jsx(P,{richColors:!0}),e.jsx(A,{title:"Edit Blotter Report"}),e.jsx(D,{breadcrumbs:S}),e.jsx("div",{children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6",children:e.jsx("div",{className:"overflow-hidden bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 my-2",children:e.jsxs("div",{className:" my-2 p-2",children:[c&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:c}),e.jsx("div",{children:e.jsxs("form",{onSubmit:B,children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 mb-6 bg-gray-50 rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(V,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-2xl font-semibold text-gray-800 mb-1",children:"Edit Blotter Report Form"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Fill out the details of the incident, including participants, actions, and recommendations. Ensure all required fields are completed before submitting."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx(j,{label:"Type of Incident",name:"type_of_incident",value:r.type_of_incident,onChange:a=>i("type_of_incident",a.target.value),placeholder:"Ex: Theft, Violence"}),e.jsx(m,{message:o.type_of_incident,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(j,{type:"datetime-local",label:"Incident Date & Time",name:"incident_date",value:r.incident_date,onChange:a=>i("incident_date",a.target.value)}),e.jsx(m,{message:o.incident_date,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(j,{label:"Location",name:"location",value:r.location,onChange:a=>i("location",a.target.value),placeholder:"Incident Location"}),e.jsx(m,{message:o.location,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(O,{label:"Report Status",name:"report_status",value:r.report_status||"",onChange:a=>i("report_status",a),items:[{label:"Pending",value:"pending"},{label:"On Going",value:"on_going"},{label:"Resolved",value:"resolved"},{label:"Elevated",value:"elevated"}],placeholder:"Select Status"}),e.jsx(m,{message:o.report_status,className:"mt-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(u,{value:"Narrative Details"}),e.jsx(p,{name:"narrative_details",value:r.narrative_details,onChange:a=>i("narrative_details",a.target.value),placeholder:"Describe what happened...",rows:4}),e.jsx(m,{message:o.narrative_details,className:"mt-1"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(u,{value:"Actions Taken"}),e.jsx(p,{name:"actions_taken",value:r.actions_taken,onChange:a=>i("actions_taken",a.target.value),placeholder:"What actions were taken?",rows:4}),e.jsx(m,{message:o.actions_taken,className:"mt-1"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(u,{value:"Resolution"}),e.jsx(p,{name:"resolution",value:r.resolution,onChange:a=>i("resolution",a.target.value),placeholder:"Resolution or settlement details...",rows:4}),e.jsx(m,{message:o.resolution,className:"mt-1"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(u,{value:"Recommendations"}),e.jsx(p,{name:"recommendations",value:r.recommendations,onChange:a=>i("recommendations",a.target.value),placeholder:"Any recommendations for next steps...",rows:4}),e.jsx(m,{message:o.recommendations,className:"mt-1"})]})]}),e.jsx(f,{title:"Complainants",dataArray:r.complainants,setDataArray:a=>i("complainants",a),errors:o,residentsList:v}),e.jsx(f,{title:"Respondents",dataArray:r.respondents,setDataArray:a=>i("respondents",a),errors:o,residentsList:v}),e.jsx(f,{title:"Witnesses",dataArray:r.witnesses,setDataArray:a=>i("witnesses",a),errors:o,residentsList:v}),e.jsxs("div",{className:"flex w-full justify-end items-center mt-7 gap-4",children:[e.jsxs(R,{type:"button",onClick:()=>L(),variant:"outline",className:"text-gray-600 border-gray-300 hover:bg-gray-50 transition duration-150",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Reset Form"]}),e.jsxs(R,{type:"submit",className:"w-40 bg-blue-600 hover:bg-blue-700 transition duration-150 shadow-md",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Submit Report"]})]})]})})]})})})})]})}export{Re as default};
