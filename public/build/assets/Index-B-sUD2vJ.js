import{K as H,r as a,j as t,L as K,$ as G,S as g,a as Q}from"./app-CSbLTV9t.js";import{S as X,B as J}from"./AdminLayout-CQAB1boG.js";import{B as _}from"./button-Baqcf9KW.js";import{I as P}from"./input-HZV2GfRj.js";import W from"./BreadcrumbsHeader-CQaDVuiA.js";import{t as k,T as Z}from"./index-BKWT8n_e.js";import"./table-BZUAIeo6.js";import"./dropdown-menu-DsAxoPEU.js";import q from"./DynamicTable-CYX8Y7lr.js";import ee from"./ActionMenu-BTyRiOW7.js";import{e as te,R as se,b as re}from"./constants-CQOY_faM.js";import{F as ae}from"./FillterToggle-p8HB-wA3.js";import"./label-DSytbWdn.js";import{u as oe}from"./useAppUrl-CCPDQKWJ.js";import ie from"./DynamicTableControls-nJkmjrjE.js";import ne from"./DeleteConfirmationModal-C2yWkaRr.js";import le from"./SidebarModal-Ca0ENWih.js";import ce from"./PersonDetailContent-BL527x7d.js";import{S as de}from"./search-w3rx2qu6.js";import{L as me}from"./list-plus-D4Korl0C.js";import{E as ue}from"./eye-CUAyTwAT.js";import{S as xe}from"./square-pen-BBjInpuo.js";import{T as pe}from"./trash-2-D7SnOmvm.js";import"./sidebar-EM1pc_Vu.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-BWMtPXXG.js";import"./index-CLKsPuj0.js";import"./floating-ui.react-dom-DHVDvaGl.js";import"./x-DSSMIW7T.js";import"./createLucideIcon-K65SoRPX.js";import"./skeleton-C3jJoeQy.js";import"./tooltip-b0GAWXCC.js";import"./nav-user-qFIfSs4r.js";import"./avatar-DBnd5X0z.js";import"./users-round-CTpkNJgD.js";import"./heart-pulse-CgKjARwL.js";import"./chevron-up-BdT9BwPw.js";import"./breadcrumb-BysmSHHT.js";import"./chevron-right-ZDo9j4tz.js";import"./check-xGOvrYiq.js";import"./ellipsis-Ci4G0pTK.js";import"./iconBase-DIY0yPu9.js";import"./index-Bw3HOa7F.js";import"./index-BqPLuFbr.js";function dt({children:C,queryParams:o,puroks:E}){const R=[{label:"Medical Information",showOnMobile:!1},{label:"Child Health Monitoring Records",showOnMobile:!0}];o=o||{};const l=H().props,m=(l==null?void 0:l.success)??null,u=(l==null?void 0:l.error)??null,M=oe(),[f,T]=a.useState(o.name??""),[F,x]=a.useState(!1),[w,O]=a.useState(null),[A,j]=a.useState(!1),[y,I]=a.useState(null),$=e=>{e.preventDefault(),p("name",f)},B=async e=>{try{const s=await Q.get(`${M}/resident/showresident/${e}`);I(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}j(!0)},p=(e,s)=>{s&&s.trim()!==""?o[e]=s:delete o[e],o.page&&delete o.page,g.get(route("child_record.index",o))},L=(e,s)=>{if(s.key==="Enter")p(e,s.target.value);else return},d=[{key:"id",label:"ID"},{key:"resident_name",label:"Name"},{key:"birthdate",label:"Birthdate"},{key:"age",label:"Age (Years)"},{key:"age_months",label:"Age (Months)"},{key:"sex",label:"Sex"},{key:"nutrition_status",label:"Nutrition Status"},{key:"latest_vaccine",label:"Latest Vaccination"},{key:"purok_number",label:"Purok"},{key:"actions",label:"Actions"}],[h,v]=a.useState(d.map(e=>e.key));a.useEffect(()=>{h.length===0&&v(d.map(e=>e.key))},[]);const[he,be]=a.useState(!0),[ge,fe]=a.useState(!1),b=Object.entries(o||{}).some(([e,s])=>["purok","sex","birthdate","nutritional_status"].includes(e)&&s&&s!=="");a.useEffect(()=>{b&&D(!0)},[b]);const[N,D]=a.useState(b),z={id:e=>e.id,resident_name:e=>{const s=e.resident;return s?`${s.firstname??""} ${s.middlename??""} ${s.lastname??""} ${s.suffix??""}`.trim():"—"},birthdate:e=>{var s;return(s=e.resident)!=null&&s.birthdate?new Date(e.resident.birthdate).toLocaleDateString():"—"},age:e=>{var c;if(!((c=e.resident)!=null&&c.birthdate))return"—";const s=new Date(e.resident.birthdate),r=new Date;let i=r.getFullYear()-s.getFullYear();const n=r.getMonth()-s.getMonth();return(n<0||n===0&&r.getDate()<s.getDate())&&i--,`${i} yrs`},age_months:e=>{var S;if(!((S=e.resident)!=null&&S.birthdate))return"—";const s=new Date(e.resident.birthdate),r=new Date,i=r.getFullYear()-s.getFullYear(),n=r.getMonth()-s.getMonth();return`${i*12+n-(r.getDate()<s.getDate()?1:0)} mos`},sex:e=>t.jsx("span",{className:`px-2 py-1 text-sm rounded-lg ${re[e.resident.sex]??"bg-gray-100 text-gray-700"}`,children:se[e.resident.sex.replace("_"," ")]}),purok_number:e=>{var s;return((s=e.resident)==null?void 0:s.purok_number)??"—"},nutrition_status:e=>{var i,n;const s={normal:"bg-green-100 text-green-700",underweight:"bg-yellow-100 text-yellow-700",severely_underweight:"bg-red-100 text-red-700",overweight:"bg-blue-100 text-blue-700",obese:"bg-purple-100 text-purple-700"},r=(n=(i=e.resident)==null?void 0:i.medical_information)==null?void 0:n.nutrition_status;return t.jsx("span",{className:`px-2 py-1 text-sm rounded-lg ${s[r]??"bg-gray-100 text-gray-700"}`,children:te[r]})},latest_vaccine:e=>{var i;const s=(i=e.resident)==null?void 0:i.vaccinations;if(!s||s.length===0)return t.jsx("span",{className:"text-gray-500",children:"No record"});const r=s.reduce((n,c)=>new Date(c.vaccination_date)>new Date(n.vaccination_date)?c:n);return t.jsxs("span",{className:"text-sm text-indigo-600 font-medium",children:[r.vaccine," ",t.jsx("br",{}),t.jsx("span",{className:"text-xs text-gray-500",children:new Date(r.vaccination_date).toLocaleDateString()})]})},actions:e=>t.jsx(ee,{actions:[{label:"View",icon:t.jsx(ue,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>B(e.resident.id)},{label:"Edit",icon:t.jsx(xe,{className:"w-4 h-4 text-green-500"}),onClick:()=>V(e.id)},{label:"Delete",icon:t.jsx(pe,{className:"w-4 h-4 text-red-600"}),onClick:()=>Y(e.id)}]})},Y=e=>{O(e),x(!0)},U=()=>{g.delete(route("child_record.destroy",w)),x(!1)},V=e=>{g.get(route("child_record.edit",e))};return a.useEffect(()=>{m&&k.success(m,{description:"Operation successful!",duration:3e3,closeButton:!0}),l.success=null},[m]),a.useEffect(()=>{u&&k.error(u,{description:"Operation failed!",duration:3e3,closeButton:!0}),l.error=null},[u]),t.jsxs(X,{children:[t.jsx(K,{title:"Blotter Reports Dashboard"}),t.jsx(W,{breadcrumbs:R}),t.jsx(Z,{richColors:!0}),t.jsx("div",{className:"pt-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:t.jsx(J,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Child Health Records"}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Track and manage child health information, including"," ",t.jsx("span",{className:"font-medium",children:"growth, nutrition, and immunization"}),". Use the tools below to search, filter, and export records for healthcare programs."]})]})]})}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:t.jsx(ie,{allColumns:d,visibleColumns:h,setVisibleColumns:v,showFilters:N,toggleShowFilters:()=>D(e=>!e)})}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:$,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(P,{type:"text",placeholder:"Search for Resident",value:f,onChange:e=>T(e.target.value),onKeyDown:e=>L("name",e),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(_,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(de,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),t.jsx(G,{href:route("child_record.create"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(_,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(me,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add a Record"})]})})]})]}),N&&t.jsx(ae,{queryParams:o,searchFieldName:p,visibleFilters:["purok","sex","birthdate","nutritional_status"],showFilters:!0,puroks:E,clearRouteName:"child_record.index",clearRouteParams:{}}),t.jsx(q,{passedData:C,allColumns:d,columnRenderers:z,queryParams:o,visibleColumns:h,showTotal:!0}),t.jsx(ne,{isOpen:F,onClose:()=>{x(!1)},onConfirm:U,residentId:w}),t.jsx(le,{isOpen:A,onClose:()=>j(!1),title:"Resident Details",children:y&&t.jsx(ce,{person:y})})]})})})]})}export{dt as default};
