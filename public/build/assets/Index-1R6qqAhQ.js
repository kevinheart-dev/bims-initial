import{K as H,r as a,j as t,L as X,$ as P,S as l,a as Q}from"./app-CSbLTV9t.js";import{S as Z}from"./AdminLayout-CQAB1boG.js";import{B as k}from"./button-Baqcf9KW.js";import{I as G}from"./input-HZV2GfRj.js";import J from"./BreadcrumbsHeader-CQaDVuiA.js";import{t as D,T as W}from"./index-BKWT8n_e.js";import"./table-BZUAIeo6.js";import"./dropdown-menu-DsAxoPEU.js";import Y from"./DynamicTable-CYX8Y7lr.js";import q from"./ActionMenu-BTyRiOW7.js";import{t as ee}from"./constants-CQOY_faM.js";import{F as te}from"./FillterToggle-p8HB-wA3.js";import"./label-DSytbWdn.js";import{u as se}from"./useAppUrl-CCPDQKWJ.js";import re from"./DynamicTableControls-nJkmjrjE.js";import ae from"./DeleteConfirmationModal-C2yWkaRr.js";import oe from"./SidebarModal-Ca0ENWih.js";import ie from"./PersonDetailContent-BL527x7d.js";import{E as ne}from"./ExportButton-BeJadOTs.js";import{L as C}from"./list-plus-D4Korl0C.js";import{S as le}from"./search-w3rx2qu6.js";import{E as de}from"./eye-CUAyTwAT.js";import{S as ce}from"./square-pen-BBjInpuo.js";import{T as me}from"./trash-2-D7SnOmvm.js";import{c as pe}from"./createLucideIcon-K65SoRPX.js";import"./sidebar-EM1pc_Vu.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-BWMtPXXG.js";import"./index-CLKsPuj0.js";import"./floating-ui.react-dom-DHVDvaGl.js";import"./x-DSSMIW7T.js";import"./skeleton-C3jJoeQy.js";import"./tooltip-b0GAWXCC.js";import"./nav-user-qFIfSs4r.js";import"./avatar-DBnd5X0z.js";import"./users-round-CTpkNJgD.js";import"./heart-pulse-CgKjARwL.js";import"./chevron-up-BdT9BwPw.js";import"./breadcrumb-BysmSHHT.js";import"./chevron-right-ZDo9j4tz.js";import"./check-xGOvrYiq.js";import"./ellipsis-Ci4G0pTK.js";import"./iconBase-DIY0yPu9.js";import"./index-Bw3HOa7F.js";import"./index-BqPLuFbr.js";import"./file-output-CJ6vmdDa.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],xe=pe("file-up",ue);function pt({blotters:E,queryParams:o,incident_types:R}){const T=[{label:"Katarungang Pambarangay",showOnMobile:!1},{label:"Blotter Reports",showOnMobile:!0}];o=o||{};const i=H().props,p=(i==null?void 0:i.success)??null,u=(i==null?void 0:i.error)??null,B=se(),[g,M]=a.useState(o.name??""),[O,x]=a.useState(!1),[y,$]=a.useState(null),[I,j]=a.useState(!1),[v,w]=a.useState(null),A=e=>{e.preventDefault(),h("name",g)},F=async e=>{try{const s=await Q.get(`${B}/resident/showresident/${e}`);w(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}j(!0)},h=(e,s)=>{s&&s.trim()!==""?o[e]=s:delete o[e],o.page&&delete o.page,l.get(route("blotter_report.index",o))},L=(e,s)=>{if(s.key==="Enter")h(e,s.target.value);else return},d=[{key:"id",label:"ID"},{key:"type_of_incident",label:"Type of Incident"},{key:"latest_complainant",label:"Complainant(s)"},{key:"report_status",label:"Status"},{key:"incident_date",label:"Incident Date"},{key:"narrative_details",label:"Narrative Details"},{key:"actions_taken",label:"Actions Taken"},{key:"recommendations",label:"Recommendations"},{key:"recorded_by",label:"Recorded By"},{key:"actions",label:"Actions"}],[f,_]=a.useState(d.map(e=>e.key));a.useEffect(()=>{f.length===0&&_(d.map(e=>e.key))},[]);const[he,fe]=a.useState(!0),[be,ge]=a.useState(!1),b=Object.entries(o||{}).some(([e,s])=>["incident_type","incident_date"].includes(e)&&s&&s!=="");a.useEffect(()=>{b&&S(!0)},[b]);const[N,S]=a.useState(b),z={id:e=>e.id,type_of_incident:e=>t.jsx("span",{className:"font-medium text-gray-800",children:e.type_of_incident}),narrative_details:e=>t.jsx("span",{className:"line-clamp-2 text-gray-600",children:e.narrative_details}),recommendations:e=>t.jsx("span",{className:"line-clamp-2 text-gray-600",children:e.recommendations}),actions_taken:e=>e.actions_taken??"—",report_status:e=>{const s={pending:"bg-yellow-100 text-yellow-700",on_going:"bg-blue-100 text-blue-700",resolved:"bg-green-100 text-green-700",elevated:"bg-red-100 text-red-700"};return t.jsx("span",{className:`px-2 py-1 text-sm rounded-lg ${s[e.report_status]??"bg-gray-100 text-gray-700"}`,children:ee[e.report_status]})},incident_date:e=>{if(!e.incident_date)return"—";const s=new Date(e.incident_date).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),r=new Date(e.incident_date).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0});return t.jsxs("div",{children:[t.jsx("div",{children:s}),t.jsxs("div",{className:"text-sm text-gray-500",children:["around ",r]})]})},recorded_by:e=>{var r,c,m,n;const s=e.recorded_by;return s?`${((r=s.resident)==null?void 0:r.firstname)??""} ${((c=s.resident)==null?void 0:c.middlename)??""} ${((m=s.resident)==null?void 0:m.lastname)??""} ${((n=s.resident)==null?void 0:n.suffix)??""}`??"—":"—"},latest_complainant:e=>{const s=e.complainants||[];return s.length===0?"—":s.map((r,c)=>{const m=r.resident?`${r.resident.firstname??""} ${r.resident.middlename??""} ${r.resident.lastname??""} ${r.resident.suffix??""}`.trim():r.name??"—";return t.jsxs("span",{children:[t.jsx("span",{className:"text-blue-600 hover:underline hover:cursor-pointer",onClick:()=>{var n;return((n=r.resident)==null?void 0:n.id)&&F(r.resident.id)},children:m}),c<s.length-1&&", "]},r.id)})},actions:e=>t.jsx(q,{actions:[{label:"View",icon:t.jsx(de,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>l.visit(route("blotter_report.show",e.id))},{label:"Edit",icon:t.jsx(ce,{className:"w-4 h-4 text-green-500"}),onClick:()=>V(e.id)},{label:"Delete",icon:t.jsx(me,{className:"w-4 h-4 text-red-600"}),onClick:()=>K(e.id)},{label:"Elevate to Summon",icon:t.jsx(xe,{className:"w-4 h-4 text-red-900"}),onClick:()=>l.visit(route("summon.elevate",e.id))}]})},K=e=>{$(e),x(!0)},U=()=>{l.delete(route("blotter_report.destroy",y)),x(!1)},V=e=>{l.get(route("blotter_report.edit",e))};return a.useEffect(()=>{p&&D.success(p,{description:"Operation successful!",duration:3e3,closeButton:!0}),i.success=null},[p]),a.useEffect(()=>{u&&D.error(u,{description:"Operation failed!",duration:3e3,closeButton:!0}),i.error=null},[u]),t.jsxs(Z,{children:[t.jsx(X,{title:"Blotter Reports Dashboard"}),t.jsx(J,{breadcrumbs:T}),t.jsx(W,{richColors:!0}),t.jsx("div",{className:"pt-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsxs("div",{className:"flex items-center gap-3 p-4 mb-6 bg-gray-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:t.jsx(C,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Blotter Reports"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Manage all blotter cases and incident reports within the barangay. Easily search, filter, export, and add new blotter records for accurate tracking and resolution."})]})]}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[t.jsx(re,{allColumns:d,visibleColumns:f,setVisibleColumns:_,showFilters:N,toggleShowFilters:()=>S(e=>!e)}),t.jsx(ne,{url:"report/export-blotter-reports-excel",queryParams:o,label:"Export Blotter Reports as XLSX"})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:A,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(G,{type:"text",placeholder:"Search for Complainant",value:g,onChange:e=>M(e.target.value),onKeyDown:e=>L("name",e),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(k,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(le,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),t.jsx(P,{href:route("blotter_report.create"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(k,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(C,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add a Blotter Report"})]})})]})]}),N&&t.jsx(te,{queryParams:o,searchFieldName:h,visibleFilters:["incident_type","incident_date"],showFilters:!0,types:R,clearRouteName:"blotter_report.index",clearRouteParams:{}}),t.jsx(Y,{passedData:E,columnRenderers:z,allColumns:d,visibleColumns:f,showTotal:!0}),t.jsx(oe,{isOpen:I,onClose:()=>{j(!1),w(null)},title:"Resident Details",children:v&&t.jsx(ie,{person:v})}),t.jsx(ae,{isOpen:O,onClose:()=>{x(!1)},onConfirm:U,residentId:y})]})})})]})}export{pt as default};
